<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Two Sample Comparisons – Survival analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./aft.html" rel="next">
<link href="./parametric.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./twosample.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Two Sample Comparisons</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Survival analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Background and Basic Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survivor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Estimating survivor functions: life-tables and Kaplan-Meier</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parametric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Parametric one-sample models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./twosample.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Two Sample Comparisons</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Accelerated Failure Time (AFT) Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proportionalhazards.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Proportional Hazards Models</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#log-rank-test-non-parametric" id="toc-log-rank-test-non-parametric" class="nav-link" data-scroll-target="#log-rank-test-non-parametric"><span class="header-section-number">4.2</span> Log Rank Test (Non-Parametric)</a>
  <ul class="collapse">
  <li><a href="#BrainTumourKM" id="toc-BrainTumourKM" class="nav-link" data-scroll-target="#BrainTumourKM"><span class="header-section-number">4.2.1</span> Example: Brain Tumour Survival Times</a></li>
  <li><a href="#implementing-the-log-rank-test" id="toc-implementing-the-log-rank-test" class="nav-link" data-scroll-target="#implementing-the-log-rank-test"><span class="header-section-number">4.2.2</span> Implementing the Log Rank Test</a></li>
  <li><a href="#log-rank-test-applied-to-the-brain-tumour-data" id="toc-log-rank-test-applied-to-the-brain-tumour-data" class="nav-link" data-scroll-target="#log-rank-test-applied-to-the-brain-tumour-data"><span class="header-section-number">4.2.3</span> Log Rank Test applied to the Brain Tumour Data</a></li>
  <li><a href="#performing-the-log-rank-test-in-r" id="toc-performing-the-log-rank-test-in-r" class="nav-link" data-scroll-target="#performing-the-log-rank-test-in-r"><span class="header-section-number">4.2.4</span> Performing the Log Rank Test in R</a></li>
  </ul></li>
  <li><a href="#parametric-tests" id="toc-parametric-tests" class="nav-link" data-scroll-target="#parametric-tests"><span class="header-section-number">4.3</span> Parametric Tests</a>
  <ul class="collapse">
  <li><a href="#MLETest" id="toc-MLETest" class="nav-link" data-scroll-target="#MLETest"><span class="header-section-number">4.3.1</span> MLE Test</a></li>
  <li><a href="#sec-MLEbrain" id="toc-sec-MLEbrain" class="nav-link" data-scroll-target="#sec-MLEbrain"><span class="header-section-number">4.3.2</span> MLE Test applied to the Brain Tumour Data</a></li>
  <li><a href="#likelihood-ratio-test" id="toc-likelihood-ratio-test" class="nav-link" data-scroll-target="#likelihood-ratio-test"><span class="header-section-number">4.3.3</span> Likelihood Ratio Test</a></li>
  <li><a href="#likelihood-ratio-test-applied-to-the-brain-tumour-data" id="toc-likelihood-ratio-test-applied-to-the-brain-tumour-data" class="nav-link" data-scroll-target="#likelihood-ratio-test-applied-to-the-brain-tumour-data"><span class="header-section-number">4.3.4</span> Likelihood Ratio Test applied to the Brain Tumour Data</a></li>
  <li><a href="#performing-the-likelihood-ratio-test-in-r" id="toc-performing-the-likelihood-ratio-test-in-r" class="nav-link" data-scroll-target="#performing-the-likelihood-ratio-test-in-r"><span class="header-section-number">4.3.5</span> Performing the Likelihood Ratio Test in R</a></li>
  </ul></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks"><span class="header-section-number">4.4</span> Tasks</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Two Sample Comparisons</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aims for this chapter
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this chapter, we will use appropriate hypothesis testing methods to compare survival times between two groups. In particular we will</p>
<ol type="1">
<li><p>study the log rank test for comparing two survivor functions, implementing the test by hand and using R;</p></li>
<li><p>use tests based on maximum likelihood for comparing two exponential distributions;</p></li>
<li><p>apply the likelihood ratio test for comparing two distributions, and implement it using R.</p></li>
</ol>
</div>
</div>
<section id="introduction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1</span> Introduction</h2>
<p>In our work so far, we have only considered data from a single sample. However, a common problem is the comparison of two (or more) survival distributions, e.g.&nbsp;we might wish to find out which of two treatments is the better or whether the pattern of survivals/deaths for Males is different from that for Females.</p>
<p>One simple comparison would be to plot the Kaplan-Meier estimates for each group. The question is then whether there is a statistically significant difference between the two curves.</p>
</section>
<section id="log-rank-test-non-parametric" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="log-rank-test-non-parametric"><span class="header-section-number">4.2</span> Log Rank Test (Non-Parametric)</h2>
<section id="BrainTumourKM" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="BrainTumourKM"><span class="header-section-number">4.2.1</span> Example: Brain Tumour Survival Times</h3>
<p>Twelve brain tumour patients were randomized and received either radiation, or radiation and chemotherapy. One year after the start of the study the survival times in weeks are shown in <a href="#tbl-BrainTumour" class="quarto-xref">Table&nbsp;<span>4.1</span></a>.</p>
<div id="tbl-BrainTumour" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-BrainTumour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Survival times of 12 patients undergoing either radiation (RT) or radiation and chemotherapy (RT+CT). A * denotes a censored observation.
</figcaption>
<div aria-describedby="tbl-BrainTumour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Group 1 RT:</th>
<th style="text-align: center;">10</th>
<th style="text-align: center;">26</th>
<th style="text-align: center;">28</th>
<th style="text-align: center;">30</th>
<th style="text-align: center;">41</th>
<th style="text-align: center;">12*</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group 2 RT+CT:</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">15*</td>
<td style="text-align: center;">40*</td>
<td style="text-align: center;">42*</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>We can produce separate Kaplan-Meier plots for each group as follows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>braintu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">41</span>, <span class="dv">12</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">42</span>, <span class="dv">15</span>, <span class="dv">40</span>, <span class="dv">42</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">censor =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"RT"</span>, <span class="st">"RT plus CT"</span>), <span class="at">each =</span> <span class="dv">6</span>)))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>brain_sv <span class="ot">&lt;-</span> <span class="fu">Surv</span>(braintu<span class="sc">$</span>time, braintu<span class="sc">$</span>censor, <span class="at">type =</span> <span class="st">"right"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>brainSurv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(brain_sv <span class="sc">~</span> group, <span class="at">data =</span> braintu)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(brainSurv, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmpair" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmpair-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="twosample_files/figure-html/fig-kmpair-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmpair-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Kaplan-Meier Estimates of the survivor functions for two brain tumour treatments
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-kmpair" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> allows a visual comparison of the K-M estimates for each treatment but we want to <strong>formally</strong> test if there is a difference in the survival functions for the two types of treatment.</p>
</section>
<section id="implementing-the-log-rank-test" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="implementing-the-log-rank-test"><span class="header-section-number">4.2.2</span> Implementing the Log Rank Test</h3>
<p>If <span class="math inline">\(S_1(t)\)</span> and <span class="math inline">\(S_2(t)\)</span> are the survival functions under the two conditions, we wish to test <span class="math display">\[\begin{align}
H_0: \quad &amp; S_1(t) = S_2(t) \nonumber \\
H_1: \quad &amp; S_1(t)\neq S_2(t) \quad \textrm{for some } t
\end{align}\]</span> To perform the test, we order the times of death for the two groups <strong>combined</strong> i.e.&nbsp;<span class="math display">\[t_{(1)} &lt; t_{(2)} &lt; \ldots\]</span> We then find the expected number of deaths in each group. Under <span class="math inline">\(H_0\)</span> where there is no difference in groups, at the occurrence of the first death at time <span class="math inline">\(t=10\)</span>, there are 12 individuals at risk and one death. Six of those individuals are in group 1 and six are in group 2. Hence, under <span class="math inline">\(H_0\)</span> we would expect <span class="math inline">\(1 \times \frac{6}{12}\)</span> of the deaths at time <span class="math inline">\(t_{(1)}\)</span> to be in group 1 and <span class="math inline">\(1\times \frac{6}{12}\)</span> of them to be in group 2.</p>
<p>The next death occurs at <span class="math inline">\(t_{(2)}=24\)</span> when there are four individuals in group 1 and five in group 2. Hence we would expect <span class="math inline">\(1\times \frac{4}{9}\)</span> deaths in group 1 and <span class="math inline">\(1 \times \frac{5}{9}\)</span> in group 2. We can continue to do this until all the deaths have occurred.</p>
<p>Having done this for every time <span class="math inline">\(t_{(i)}\)</span> we can sum the number of expected deaths in each group to find <span class="math inline">\(E_{i}\)</span>, the expected total number of deaths in group <span class="math inline">\(i\)</span>. We can compare these with the total observed number of deaths <span class="math inline">\(O_i\)</span> in the groups and find the log-rank statistic under <span class="math inline">\(H_0\)</span>. <span class="math display">\[
LR = \frac{(O_1 - E_1)^2}{E_1} + \frac{(O_2 - E_2)^2}{E_2} \sim \chi^2_1
\]</span></p>
</section>
<section id="log-rank-test-applied-to-the-brain-tumour-data" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="log-rank-test-applied-to-the-brain-tumour-data"><span class="header-section-number">4.2.3</span> Log Rank Test applied to the Brain Tumour Data</h3>
<p>We perform this test on our Brain Tumour data as shown in <a href="#tbl-LRTest" class="quarto-xref">Table&nbsp;<span>4.2</span></a>. In the table, <span class="math inline">\(r\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(e\)</span> represent the numbers at risk, actual number of deaths and expected number of deaths respectively. Here <span class="math display">\[LR = 2.46 &lt; \chi^2_{1, 0.95}\]</span> i.e.&nbsp;there is no significant difference in survivor functions at the 5% level.</p>
<div id="tbl-LRTest" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-LRTest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Calculations for the log rank test applied to the brain tumour data.
</figcaption>
<div aria-describedby="tbl-LRTest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r_{1i}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r_{2i}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(r_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(d_{1i}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(d_{2i}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(d_i\)</span></td>
<td style="text-align: left;"><span class="math inline">\(e_{1i}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(e_{2i}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">1/2</td>
<td style="text-align: left;">1/2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">4/9</td>
<td style="text-align: left;">5/9</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">1/2</td>
<td style="text-align: left;">1/2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">3/7</td>
<td style="text-align: left;">4/7</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;">2/3</td>
<td style="text-align: left;">4/3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">1/3</td>
<td style="text-align: left;">2/3</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Totals</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(O_1 = 5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O_2 = 3\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"><span class="math inline">\(E_1 = 2.87\)</span></td>
<td style="text-align: left;"><span class="math inline">\(E_2 = 5.13\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The log rank test can be generalised to more than 2 groups. If we have <span class="math inline">\(k\)</span> groups then the log rank statistic has a <span class="math inline">\(\chi^2_{k-1}\)</span> distribution under <span class="math inline">\(H_0\)</span>.</p>
</section>
<section id="performing-the-log-rank-test-in-r" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="performing-the-log-rank-test-in-r"><span class="header-section-number">4.2.4</span> Performing the Log Rank Test in R</h3>
<p>The function for performing log rank tests is <code>survdiff()</code>. The procedure is similar to calculating a non-parametric (i.e.&nbsp;Kaplan-Meier) survival model. We start by creating a survival object using the <code>Surv()</code> function. We then regress the <code>Surv</code> object on the group variable. We do this for the brain tumour survival times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(braintu) <span class="co"># look for name of grouping variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "time"   "censor" "group" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(brain_sv <span class="sc">~</span> group, <span class="at">data =</span> braintu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = brain_sv ~ group, data = braintu)

                 N Observed Expected (O-E)^2/E (O-E)^2/V
group=RT         6        5     2.87     1.575      2.88
group=RT plus CT 6        3     5.13     0.882      2.88

 Chisq= 2.9  on 1 degrees of freedom, p= 0.09 </code></pre>
</div>
</div>
<p>Note that the numerical value of the test statistic is slightly different from our log rank statistic value of 2.46 since R handles ties in a more sophisticated way.</p>
</section>
</section>
<section id="parametric-tests" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="parametric-tests"><span class="header-section-number">4.3</span> Parametric Tests</h2>
<p>To perform parametric tests, we generally need to use asymptotic properties of maximum likelihood estimates of parameters or likelihood ratios. The exponential lifetime model is given here as an illustration, but all other models could be handled similarly with numerical estimation of parameters and the asymptotic variances.</p>
<section id="MLETest" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="MLETest"><span class="header-section-number">4.3.1</span> MLE Test</h3>
<p>Suppose we have <span class="math inline">\(n_1\)</span> observations of <span class="math inline">\(T_1 \sim Exp(\lambda_1)\)</span> and <span class="math inline">\(n_2\)</span> observations of <span class="math inline">\(T_2 \sim Exp(\lambda_2)\)</span>. Now the mles are given by <span class="math display">\[\hat{\lambda}_j = \frac{\sum_{i=1}^{n_j} \delta_{ji}}{\sum_{i=1}^{n_j} t_{ji}} = \frac{\Delta_j}{\mathcal{T}_j} \quad \textrm{for } j = 1, 2;\]</span> where <span class="math inline">\(\Delta_j\)</span> is the number of deaths in group <span class="math inline">\(j\)</span> and <span class="math inline">\(\mathcal{T}_j\)</span> is the total time on test in group <span class="math inline">\(j\)</span> (i.e the sum of all observed failure times and censored times).</p>
<p>Using the results in <a href="parametric.html#sec-censExp" class="quarto-xref"><span>Section 3.1.2</span></a> we know that <span class="math display">\[\hat{\lambda}_j \approx N \left( \lambda_j, \frac{\lambda_j^2}{\Delta_j} \right) \quad \textrm{for } j = 1, 2.\]</span> Replacing <span class="math inline">\(\lambda_j\)</span> in the variance term with its estimate <span class="math inline">\(\hat{\lambda}_j\)</span> we have <span class="math display">\[\hat{\lambda}_1 - \hat{\lambda}_2 \approx N \left( \lambda_1 - \lambda_2 , \frac{\hat{\lambda}_1^2}{\Delta_1} + \frac{\hat{\lambda}_2^2}{\Delta_2}\right).\]</span> Hence, to test the hypothesis <span class="math display">\[\begin{align}
H_0: \quad &amp; S_1(t) = S_2(t) \\
H_1: \quad &amp; S_1(t)\neq S_2(t) \quad \textrm{for some } t
\end{align}\]</span> we first note that (in our parametric setting) it is equivalent to testing <span class="math display">\[\begin{align}
H_0: \quad &amp; \lambda_1 =\lambda_2 \\
H_1: \quad &amp; \lambda_1  \neq \lambda_2
\end{align}\]</span> and under <span class="math inline">\(H_0\)</span> <span class="math display">\[\begin{equation}
W=\frac{\hat{\lambda}_1-\hat{\lambda}_2}{\sqrt{\frac{\hat{\lambda}_1^2}{\Delta_1}+\frac{\hat{\lambda}_2^2}{\Delta_2}}}\approx N(0,1).
\end{equation}\]</span></p>
</section>
<section id="sec-MLEbrain" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="sec-MLEbrain"><span class="header-section-number">4.3.2</span> MLE Test applied to the Brain Tumour Data</h3>
<p>We have</p>
<ul>
<li><p><span class="math inline">\(n_1= 6, \; \Delta_1=5 \; \mathcal{T}_1=147, \; \hat{\lambda}_1 = 5/147 = 0.034\)</span></p></li>
<li><p><span class="math inline">\(n_2=6, \; \Delta_2=3, \; \mathcal{T}_2=193, \; \hat{\lambda}_2 = 3/193=0.0155\)</span></p></li>
</ul>
<p>These give <span class="math inline">\(W=1.05\)</span> and comparing this with 1.96 (0.975 quantile of the <span class="math inline">\(N(0,1)\)</span> distribution) we have no evidence at the 5% level that the survivor functions differ.</p>
</section>
<section id="likelihood-ratio-test" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="likelihood-ratio-test"><span class="header-section-number">4.3.3</span> Likelihood Ratio Test</h3>
<p>An alternative parametric approach is to use the likelihood ratio test. We have the likelihood <span class="math display">\[L(\lambda_1,\lambda_2) = L(\lambda_1)L(\lambda_2)\]</span> and so to maximize <span class="math inline">\(L(\lambda_1,\lambda_2)\)</span> we can maximise with respect to <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span> separately. Equation @ref(eq:censexplike) gives <span class="math display">\[L_{max}(\lambda_1,\lambda_2) = L(\hat{\lambda}_1, \hat{\lambda}_2) = \hat{\lambda}_1^{\Delta_1} e^{-\hat{\lambda}_1 \mathcal{T}_1} \hat{\lambda}_2^{\Delta_2} e^{-\hat{\lambda}_2 \mathcal{T}_2}\]</span> where <span class="math inline">\(\hat{\lambda}_i = \frac{\Delta_i}{\mathcal{T}_i}\)</span> for <span class="math inline">\(i = 1, 2\)</span>. Whereas, if <span class="math inline">\(H_0\)</span> is true, then the likelihood is <span class="math display">\[\begin{align}
L(\lambda,\lambda) &amp;= \lambda^{\Delta_1 + \Delta_2} e^{-\lambda (\mathcal{T}_1 +\mathcal{T}_2)} \\
\Rightarrow l(\lambda,\lambda) &amp;= (\Delta_1+\Delta_2)\log \lambda - \lambda (\mathcal{T}_1 +\mathcal{T}_2) \\
\Rightarrow \tilde{\lambda} &amp;= \frac{\Delta_1+\Delta_2}{\mathcal{T}_1 +\mathcal{T}_2} \\
\Rightarrow L(\tilde{\lambda},\tilde{\lambda}) &amp;=  \tilde{\lambda}^{\Delta_1 + \Delta_2} e^{-\tilde{\lambda} (\mathcal{T}_1 +\mathcal{T}_2)}.
\end{align}\]</span> where <span class="math inline">\(\tilde{\lambda} = \frac{\Delta_1 + \Delta_2}{\mathcal{T}_1+ \mathcal{T}_2}\)</span> is the MLE under <span class="math inline">\(H_0\)</span>. So using the generalised likelihood ratio test we have, under <span class="math inline">\(H_0\)</span>, <span class="math display">\[2 \left\{ l(\hat{\lambda}_1, \hat{\lambda}_2) - l(\tilde{\lambda},\tilde{\lambda}) \right\} \approx \chi^2_1\]</span> i.e.&nbsp;<span class="math display">\[\begin{equation}
2 \left\{ \Delta_1 \log \frac{\Delta_1}{\mathcal{T}_1} + \Delta_2 \log \frac{\Delta_2}{\mathcal{T}_2} - (\Delta_1 + \Delta_2) \log \frac{\Delta_1 + \Delta_2}{\mathcal{T}_1 + \mathcal{T}_2} \right\} \approx \chi^2_1
\end{equation}\]</span></p>
</section>
<section id="likelihood-ratio-test-applied-to-the-brain-tumour-data" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="likelihood-ratio-test-applied-to-the-brain-tumour-data"><span class="header-section-number">4.3.4</span> Likelihood Ratio Test applied to the Brain Tumour Data</h3>
<p>Calculation gives the test statistic as 1.20 and since <span class="math inline">\(1.20 &lt; 3.84\)</span> (<span class="math inline">\(\chi^2_{1, 0.95}=3.84\)</span>) we again have no evidence at the 5% level that the survivor functions differ.</p>
</section>
<section id="performing-the-likelihood-ratio-test-in-r" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="performing-the-likelihood-ratio-test-in-r"><span class="header-section-number">4.3.5</span> Performing the Likelihood Ratio Test in R</h3>
<p>We can do the MLE test using the <code>survreg()</code> function by specifying the <code>dist</code> argument to be <code>exponential</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>brain_sv <span class="ot">&lt;-</span> <span class="fu">Surv</span>(braintu<span class="sc">$</span>time, braintu<span class="sc">$</span>censor)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>br_regexp <span class="ot">&lt;-</span> <span class="fu">survreg</span>(brain_sv <span class="sc">~</span> group, <span class="at">data =</span> braintu, <span class="at">dist =</span> <span class="st">"exponential"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(br_regexp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
survreg(formula = brain_sv ~ group, data = braintu, dist = "exponential")
                Value Std. Error    z     p
(Intercept)     3.381      0.447 7.56 4e-14
groupRT plus CT 0.783      0.730 1.07  0.28

Scale fixed at 1 

Exponential distribution
Loglik(model)= -37.4   Loglik(intercept only)= -38
    Chisq= 1.2 on 1 degrees of freedom, p= 0.27 
Number of Newton-Raphson Iterations: 4 
n= 12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>br_regexp<span class="sc">$</span>var <span class="co"># gives the covariance matrix of the model estimates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                (Intercept) groupRT plus CT
(Intercept)             0.2      -0.2000000
groupRT plus CT        -0.2       0.5333333</code></pre>
</div>
</div>
<p>Note that:</p>
<ul>
<li><p><span class="math inline">\(\hat \lambda_1 = 1/\exp(3.381) = 0.034\)</span></p></li>
<li><p><span class="math inline">\(\hat \lambda_2 = 1/\exp(3.381+0.783) = 0.015\)</span></p></li>
<li><p>Previously, in <a href="parametric.html#sec-censExp" class="quarto-xref"><span>Section 3.1.2</span></a>, we found <span class="math inline">\(\text{se}(\hat \lambda_1) \approx \exp(-3.381)/\sqrt{5}\)</span></p></li>
<li><p><span class="math inline">\(\text{se}(\hat \lambda_2) \approx (0.447^2+0.7302^2 + 2(-0.2))^{\frac{1}{2}}/\exp(3.381+0.783)\)</span></p></li>
<li><p>It is simpler to note in the <code>R</code> output that the p-value for testing whether the parameter indicating the group is zero is 0.28 (this tests whether the groups differ in their survival curves)</p></li>
<li><p>This is close to the <span class="math inline">\(p\)</span>-value of 0.29 for the MLE test statistic of 1.05 calculated in <a href="#sec-MLEbrain" class="quarto-xref"><span>Section 4.3.2</span></a> given by <code>2*(1-pnorm(1.05)</code></p></li>
<li><p>The <span class="math inline">\(\chi^2_1\)</span> value of 1.2 (giving a p-value of 0.27) given above is the value of the likelihood ratio test statistic.</p></li>
</ul>
<p>It can be shown that the MLE and likelihood ratio tests are asymptotically equivalent so for large sample sizes they should lead to similar conclusions. There is some research showing that the LRT is more appropriate for small samples although this is not a hard rule. In large samples, little power is gained by using parametric methods instead of the log-rank test.</p>
</section>
</section>
<section id="tasks" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="tasks"><span class="header-section-number">4.4</span> Tasks</h2>
<p>Consider again the leukaemia data from the Chapter 2 Tasks. We have the time to relapse (in weeks), following remission, for a group of leukaemia patients treated with a particular drug “Drug-6-MP”: (* indicates a right censored value).</p>
<p><span class="math display">\[6^*, 6, 6, 6, 7, 9^*, 10^*, 10, 11^*, 13, 16,\]</span></p>
<p><span class="math display">\[17^*, 19^*, 20^*, 22, 23, 25^*, 32^*, 34^*, 35^*\]</span></p>
<p>In addition, there was a control group, with patients randomised to either the drug or control. Times to relapse for the control group were as follows: <span class="math display">\[
1, 1, 2, 2, 3, 4, 4, 5, 5, 8, 8,
\]</span> <span class="math display">\[
8, 8, 11, 11, 12, 12, 15, 17, 22, 23
\]</span></p>
<ol type="1">
<li><p>Use a log rank test to compare the two groups and report your conclusions. Do the calculations by hand!</p></li>
<li><p>Use the following code to set up the data in R. Then do the log rank test in R to check your result. Note that the R output will give the same expected number of remissions in each group, but will report a slightly different test statistic value, as it applies an adjustment for tied event times. You don’t need to worry about this!</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>leukaemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">10</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">19</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">32</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">34</span>, <span class="dv">35</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">8</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">23</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">censor =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">21</span>)),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"drug6MP"</span>, <span class="st">"control"</span>), <span class="at">each =</span> <span class="dv">21</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Do a suitable plot in R to compare the two groups, and comment on how this relates to your result in question 1.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./parametric.html" class="pagination-link" aria-label="Parametric one-sample models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Parametric one-sample models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./aft.html" class="pagination-link" aria-label="Accelerated Failure Time (AFT) Models">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Accelerated Failure Time (AFT) Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>