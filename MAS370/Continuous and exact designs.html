<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Continuous and exact designs – MAS370/61003 Sampling Theory and Design of Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Tailor-made designs.html" rel="next">
<link href="./Designs for mixture experiments.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Introduction to experimental design.html">Part I: Experimental Design</a></li><li class="breadcrumb-item"><a href="./Continuous and exact designs.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Continuous and exact designs</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MAS370/61003 Sampling Theory and Design of Experiments</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructions</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part I: Experimental Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to experimental design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Experimental Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Review of linear models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A review of linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Optimality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Optimality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Qualitative-single factor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Designs for qualitative explanatory variables: one factor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Qualitative-multiple factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Designs for qualitative explanatory variables: multiple factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Factorial designs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Factorial designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Designs for mixture experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Designs for mixture experiments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Continuous and exact designs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Continuous and exact designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tailor-made designs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tailor-made designs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part II: Sampling Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Simple random sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Simple Random Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Stratified sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Stratified Sampling: Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Cluster sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Cluster Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Population size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Estimating a Population Size</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Practicalities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Practicalities of Surveys: Problems at the Planning Stage</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part III: Computer Experiments (MAS61003 only)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction-computer-experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Uncertainty-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Uncertainty analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Sensitivity-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Sensitivity analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-general-equivalence-theorem" id="toc-the-general-equivalence-theorem" class="nav-link active" data-scroll-target="#the-general-equivalence-theorem"><span class="header-section-number">8.1</span> The General Equivalence Theorem</a></li>
  <li><a href="#appendix-proof-of-the-get" id="toc-appendix-proof-of-the-get" class="nav-link" data-scroll-target="#appendix-proof-of-the-get"><span class="header-section-number">8.2</span> Appendix: proof of the GET</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Introduction to experimental design.html">Part I: Experimental Design</a></li><li class="breadcrumb-item"><a href="./Continuous and exact designs.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Continuous and exact designs</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Continuous and exact designs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We now return to the topic of optimality of designs, with continuous explanatory variables.</p>
<p>Constructing an experimental design entails selecting points <span class="math inline">\(\mathbf{x}_1, \mathbf{x}_2, \ldots ,\mathbf{x}_k\in \Omega\)</span>, where <span class="math inline">\(\Omega\)</span> is the design region, and taking observations at each of these points, possibly with replication, so that, in general, we take, say, <span class="math inline">\(n_1\)</span> observations at <span class="math inline">\(\mathbf{x}_1\)</span>, <span class="math inline">\(n_2\)</span> observations at <span class="math inline">\(\mathbf{x}_2\)</span>, …, <span class="math inline">\(n_k\)</span> observations at <span class="math inline">\(\mathbf{x}_k\)</span>, where <span class="math display">\[\sum _{i=1}^k n_i = n\]</span> and <span class="math inline">\(n\)</span> is the total number of observations.</p>
<p>The set of design points chosen is called the <strong>support</strong> of the design. In terms of the proportions of the observations taken at the points of the support, we may denote the design symbolically by <span class="math display">\[\xi = \left( \begin{array}{cccc} \mathbf{x}_1 &amp; \mathbf{x}_2 &amp; \ldots &amp; \mathbf{x}_k
\\ \frac{n_1}{n} &amp; \frac{n_2}{n} &amp; \ldots &amp; \frac{n_k}{n}
\end{array} \right).\]</span> Such a design is called an <strong>exact</strong> design, because it can be realised in practice, but for theoretical purposes it is useful more generally to consider <strong>continuous</strong> designs, where the proportions above are replaced by <strong>weights</strong>, which are non-negative real numbers <span class="math inline">\(w_1, w_2, \ldots , w_k\)</span> adding up to one, so that a continuous design may be written <span class="math display">\[\xi = \left( \begin{array}{cccc} \mathbf{x}_1 &amp; \mathbf{x}_2 &amp; \ldots &amp; \mathbf{x}
_k \\ w_1 &amp; w_2 &amp; \ldots &amp; w_k \end{array} \right) .\]</span> A continuous design cannot necessarily be realised in practice, for example if some of the weights are irrational numbers, but it can be approximated by an exact design with enough observations.</p>
<p>The reason why we put an emphasis on weights rather than on numbers of replicates is that the optimality or otherwise of a design really only depends upon these weights. We can now define the information matrix of a continuous design for a given model as <span class="math display">\[\mathbf{M}(\xi)=\sum _{i=1}^k w_i \mathbf{f}(\mathbf{x}_i) \mathbf{f}(\mathbf{x}_i)^T\]</span> and the variance of prediction as <span class="math display">\[d(\mathbf{x},\xi ) = \mathbf{f}(\mathbf{x})^T \mathbf{M}(\xi ) ^{-1}\mathbf{f}(\mathbf{x})\]</span> which means that, if the design is in fact an exact design, these coincide with the standardised information matrix and the standardised variance of prediction which we have mentioned earlier. To check this consider 3 design points <span class="math inline">\(x_1,x_2,x_3\)</span> with <span class="math inline">\(f(x_i)^T= \left(1 \; x_i \right)\)</span> and with 2 observations at <span class="math inline">\(x_2\)</span> and one at both <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_3\)</span>. Verify that <span class="math inline">\(\mathbf{M}(\xi )\)</span> is the same as the standardised information matrix in this example.</p>
<section id="the-general-equivalence-theorem" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="the-general-equivalence-theorem"><span class="header-section-number">8.1</span> The General Equivalence Theorem</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The General Equivalence Theorem (GET)
</div>
</div>
<div class="callout-body-container callout-body">
<div id="thm-get" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8.1</strong></span> The following three statements are equivalent.</p>
<ol type="1">
<li><p>The design <span class="math inline">\(\xi^*\)</span> maximises <span class="math inline">\(|\mathbf{M}(\xi )|\)</span>.</p></li>
<li><p>The design <span class="math inline">\(\xi^*\)</span> minimises <span class="math inline">\(\max_{\mathbf{x}\in \Omega}d(\mathbf{x},\xi)\)</span>.</p></li>
<li><p><span class="math inline">\(\max_{\mathbf{x}\in \Omega }d(\mathbf{x}, \xi^*)=p\)</span>.</p></li>
</ol>
</div>
</div>
</div>
<p>In other words, for continuous designs, <span class="math inline">\(D\)</span>-optimality and <span class="math inline">\(G\)</span>-optimality are equivalent, and an optimal design by either of these criteria can be identified by the fact that the maximum variance of prediction is equal to the number of parameters in the model. The proof of the GET is given in the appendix below. It is <strong>not</strong> examinable.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<div id="exm-GET1" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.1</strong></span> In Question 2 of <a href="Optimality.html#exr-quadReg" class="quarto-xref">Exercise&nbsp;<span>3.1</span></a> we showed for the quadratic regression model that the design which gives equal weights to the points <span class="math inline">\(-1, 0\)</span> and 1 satisfies <span class="math display">\[\max _{x \in [-1,1] }d(x) = 3\]</span> which is the number of parameters in the model. We also showed that this design is <span class="math inline">\(D\)</span>-optimal over a restricted range of choices, and that the maximum in the above is achieved at each of the points of support of the design. The proof of the GET now tells us that this latter is no accident, and, more importantly, that the design is both <span class="math inline">\(D\)</span>-optimal and <span class="math inline">\(G\)</span>-optimal over <em>all</em> possible choices of design for this model.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<div id="exm-GET2" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.2</strong></span> Still with the quadratic regression model, consider the design <span class="math display">\[\xi = \left( \begin{array}{cccc}-1&amp;-\frac{1}{3}&amp;\frac{1}{3}&amp;1\\ \frac{1}{4}&amp;\frac{1}{4}&amp;\frac{1}{4}&amp;\frac{1}{4}\end{array}\right).\]</span> In this case, with one observation at each of the four points, <span class="math display">\[\mathbf{x}= \left( \begin{array}{ccc}1&amp;-1&amp;1\\1&amp;-\frac{1}{3}&amp;\frac{1}{9}\\1&amp;\frac{1}{3}&amp;\frac{1}{9}\\1&amp;1&amp;1\end{array}\right)\]</span> and therefore <span class="math display">\[\mathbf{X}^T\mathbf{X}=\left(\begin{array}{ccc}4&amp;0&amp;\frac{20}{9}\\0&amp;\frac{20}{9}&amp;0\\ \frac{20}{9}&amp;0&amp;\frac{164}{81}\end{array}\right).\]</span> The standardised variance of prediction is <span class="math display">\[\begin{align}
d(x)&amp;=4\mathbf{f}(\mathbf{x})^T(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{f}(\mathbf{x})\\
&amp;= 2.562 - 3.811x^2 + 5.062x^4\\
&amp;= 5.062[(x^2-0.376)^2-0.376^2]+2.562
\end{align}\]</span> which attains its maximum value 3.814 at <span class="math inline">\(x=\pm 1\)</span>. This is greater than 3, and so the design is not <span class="math inline">\(D\)</span>-optimal or <span class="math inline">\(G\)</span>-optimal for this model.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This is quite hard! Don’t worry if you can’t do it, but the solution will help you understand the GET a little better.
</div>
</div>
<div class="callout-body-container callout-body">
<div id="exr-GET" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.1</strong></span> Show that a CFD or FFD satisfies the conditions of the GET for a model with any number of product terms (but no squared terms) included, if the factors are quantitative variables, each taking values in the interval <span class="math inline">\([-1,1]\)</span>. Hint: consider the standardised variance of prediction, consider what sort of terms it can have, and how these might be maximised.</p>
</div>
</div>
</div>
</section>
<section id="appendix-proof-of-the-get" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="appendix-proof-of-the-get"><span class="header-section-number">8.2</span> Appendix: proof of the GET</h2>
<p>You will not be examined on this proof.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lemma
</div>
</div>
<div class="callout-body-container callout-body">
<div id="lem-get" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 8.1</strong></span> For any continuous design, and model with <span class="math inline">\(p\)</span> parameters, <span class="math display">\[ \sum _{i=1}^k w_id(\mathbf{x} _i,\xi ) = p. \]</span></p>
</div>
</div>
</div>
<p><strong>Proof</strong> <span class="math display">\[\begin{align}
\sum _{i=1}^k w_id(\mathbf{x} _i,\xi ) &amp;= \sum _{i=1}^k w_i\mathbf{f} (\mathbf{x}
_i)^T\mathbf{M} (\xi ) ^{-1}\mathbf{f} (\mathbf{x} _i) \\
&amp;=  tr\left( \mathbf{M} (\xi ) ^{-1}\sum _{i=1}^k w_i\mathbf{f} (\mathbf{x}
_i)\mathbf{f} (\mathbf{x} _i)^T \right) \\
&amp;= tr\left( \mathbf{M} (\xi ) ^{-1}\mathbf{M} (\xi )\right) \\
&amp;= tr (\mathbf{I} _p) = p
\end{align}\]</span> where we are using the fact that the trace of a scalar is itself, and the general results that <span class="math inline">\(tr(\lambda \mathbf{A} +\mathbf{B} )=\lambda \mbox{~tr~}\mathbf{A}
+\mbox{tr~}\mathbf{B}\)</span> and <span class="math inline">\(tr(\mathbf{A} \mathbf{B})=tr(\mathbf{B} \mathbf{A})\)</span> whenever these equations make sense.</p>
<p>In words, this lemma states that the weighted average of the variances of prediction at the design points, with weights those of the design, is equal to the number of parameters in the model.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lemma
</div>
</div>
<div class="callout-body-container callout-body">
<div id="lem-lemmadifdet" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 8.2</strong></span> If <span class="math inline">\(\mathbf{A} (\alpha )=(A_{ij}(\alpha ))\)</span> is a <span class="math inline">\(p\times p\)</span> positive definite matrix function of a real variable <span class="math inline">\(\alpha\)</span> and its components are differentiable with respect to <span class="math inline">\(\alpha\)</span>, then <span class="math display">\[
\frac{\partial}{\partial \alpha}\ln \left|\mathbf{A} \right| = tr\left(
\mathbf{A}^{-1} \frac{\partial \mathbf{A}}{\partial \alpha} \right).
\]</span></p>
</div>
</div>
</div>
<p><strong>Proof</strong></p>
<p><span class="math display">\[\begin{align}
\frac{\partial }{\partial \alpha }\ln |\mathbf{A} | &amp;= \frac{1}{|\mathbf{A}
|}\frac{\partial }{\partial \alpha }|\mathbf{A} | \\
&amp;= \frac{1}{|\mathbf{A} |} \sum _{i=1}^p \sum _{j=1}^p \frac{\partial
|\mathbf{A} |}{\partial A_{ij}} \frac{\partial A_{ij}}{\partial \alpha }\\
&amp;= \frac{1}{|\mathbf{A} |} \sum _{i=1}^p \sum _{j=1}^p B_{ij}
\frac{\partial A_{ij}}{\partial \alpha }\\
&amp; &amp; \mbox{where~$B_{ij}$~is~the~cofactor~of~$A_{ij}$}\\
&amp;= \frac{1}{|\mathbf{A} |} \sum _{i=1}^p \sum _{j=1}^p |\mathbf{A} |(\mathbf{A}
^{-1})_{ji} \frac{\partial A_{ij}}{\partial \alpha }\\
&amp;= tr\left( \mathbf{A} ^{-1} \frac{\partial \mathbf{A} }{\partial \alpha
} \right) .
\end{align}\]</span></p>
<p>Next, we introduce the concept of a <strong>mixture</strong> of two or more designs. If <span class="math inline">\(\xi _1\)</span> and <span class="math inline">\(\xi _2\)</span> are any two designs on the same design region, and <span class="math inline">\(0&lt; \alpha &lt;1\)</span>, then the mixture <span class="math inline">\((1-\alpha )\xi
_1+\alpha \xi _2\)</span> is found by uniting the supports of the two designs and assigning weights to which one or both of <span class="math inline">\(\xi_1\)</span> and <span class="math inline">\(\xi_2\)</span> may contribute in the correct proportions <span class="math inline">\(1-\alpha\)</span> and <span class="math inline">\(\alpha\)</span>. (If <span class="math inline">\(\alpha =0\)</span> or <span class="math inline">\(\alpha =1\)</span>, the mixture has an obvious interpretation.)</p>
<p>As an example, consider finding <span class="math inline">\(\xi =\frac{1}{4}\xi _1+\frac{3}{4}\xi _2\)</span>, where <span class="math display">\[ \xi _1= \left( \begin{array}{ccc} -1 &amp; 0 &amp; 1 \\ \frac{1}{3} &amp;
\frac{1}{3} &amp; \frac{1}{3} \end{array} \right) \mbox{~~~~and~~~~} \xi
_2= \left( \begin{array}{ccc} -2 &amp; 0 &amp; 2 \\ \frac{1}{4} &amp;
\frac{1}{2} &amp; \frac{1}{4} \end{array} \right) .\]</span> Here the support of the mixture is <span class="math inline">\(\{ -2,-1,0,1,2\}\)</span> and the point <span class="math inline">\(0\)</span> receives weight from both of the designs, whereas the other points only receive weight from one. We get <span class="math display">\[ \xi = \left( \begin{array}{ccccc} -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 \\
\frac{3}{16} &amp; \frac{1}{12} &amp; \frac{11}{24} &amp; \frac{1}{12} &amp;
\frac{3}{16} \end{array} \right) . \]</span></p>
<p>From our point of view, the important thing about mixtures is that information matrices mix in the same way. In other words, if <span class="math inline">\(\xi =(1-\alpha )\xi _1 +\alpha
\xi _2\)</span> then <span class="math display">\[ \mathbf{M} (\xi ) = (1-\alpha )\mathbf{M} (\xi _1)+\alpha \mathbf{M} (\xi _2) . \]</span> This is obvious from the definition of the information matrix of a continuous design.</p>
<p>The following result is needed here, but we shall not prove it.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lemma
</div>
</div>
<div class="callout-body-container callout-body">
<div id="lem-lemmaconcave" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 8.3</strong></span> <span class="math inline">\(\ln |\mathbf{M} (\xi )|\)</span> is a <em>concave</em> function of <span class="math inline">\(\xi\)</span>, namely <span class="math display">\[\ln |\mathbf{M} ((1-\alpha )\xi _1+\alpha \xi _2)| \geq (1-\alpha )\ln |\mathbf{M}
(\xi_1)| + \alpha \ln |\mathbf{M} (\xi _2)|\]</span> for any <span class="math inline">\(\xi_1,\xi _2,\alpha\)</span>.</p>
</div>
</div>
</div>
<p>We now have the results needed to prove <a href="Simple random sampling.html#thm-get" class="quarto-xref">Theorem&nbsp;<span>11.2</span></a> (GET).</p>
<p>Let <span class="math inline">\(\xi ^*\)</span> be a design which maximises <span class="math inline">\(|\mathbf{M} (\xi )|\)</span>. For some other fixed design <span class="math inline">\(\xi _0\)</span>, consider mixtures of the form <span class="math display">\[ \xi = (1-\alpha )\xi ^* + \alpha \xi _0 . \]</span> Then by <a href="#lem-lemmadifdet" class="quarto-xref">Lemma&nbsp;<span>8.2</span></a> <span class="math display">\[\begin{align}
\frac{\partial }{\partial \alpha }\ln |\mathbf{M} (\xi )||_{\alpha =0} &amp; =
tr\left( \mathbf{M} (\xi )^{-1}\frac{\partial }{\partial \alpha
}\mathbf{M}
(\xi )\right) |_{\alpha =0} \\
&amp;= tr\left( \mathbf{M} (\xi )^{-1}\frac{\partial }{\partial
\alpha }((1-\alpha )\mathbf{M} (\xi ^*) + \alpha \mathbf{M} (\xi _0))\right)
|_{\alpha =0} \\
&amp;= tr\left( \mathbf{M} (\xi )^{-1}(\mathbf{M} (\xi _0)-\mathbf{M} (\xi
^*))\right ) |_{\alpha =0} \\
&amp;= tr\left( \mathbf{M} (\xi ^*)^{-1}\mathbf{M} (\xi _0)\right) - p
\end{align}\]</span> since <span class="math inline">\(\mathbf{M} (\xi ) = \mathbf{M} (\xi ^*)\)</span> at <span class="math inline">\(\alpha =0\)</span>. As <span class="math inline">\(\xi ^*\)</span> maximises <span class="math inline">\(|\mathbf{M} (\xi )|\)</span>, the above partial derivative must be non-positive, and so we get <span class="math display">\[ tr\left( \mathbf{M} (\xi ^*)^{-1}\mathbf{M} (\xi _0)\right) \leq p . \]</span> If we choose <span class="math inline">\(\xi _0\)</span> to be the design with all its weight at a point <span class="math inline">\(\mathbf{x}\)</span> in the design region, we get <span class="math display">\[\begin{align}
tr\left( \mathbf{M} (\xi ^*)^{-1}\mathbf{M} (\xi _0)\right) &amp;=
tr\left( \mathbf{M} (\xi ^*)^{-1}\mathbf{f} (\mathbf{x} )\mathbf{f} (\mathbf{x} )^T\right) \\
&amp;= \mathbf{f} (\mathbf{x} )^T\mathbf{M} (\xi ^*)^{-1}\mathbf{f} (\mathbf{x} ) \\
&amp;= d(\mathbf{x}, \xi ^*)
\end{align}\]</span> and so it follows that <span class="math inline">\(d(\mathbf{x} ,\xi ^*)\leq p\)</span> for all points <span class="math inline">\(\mathbf{x}\)</span> in the design region. But <a href="#lem-get" class="quarto-xref">Lemma&nbsp;<span>8.1</span></a> tells us that a weighted average of the values of <span class="math inline">\(d(\mathbf{x},\xi ^*)\)</span> over the points of support of <span class="math inline">\(\xi^*\)</span> is equal to <span class="math inline">\(p\)</span>. It follows that <span class="math inline">\(d(\mathbf{x} ,\xi^*)\)</span> is actually equal to <span class="math inline">\(p\)</span> at each of these points, and that, as a function of <span class="math inline">\(\mathbf{x}\)</span>, it reaches its maximum value at each of these points. Moreover, again by <a href="#lem-get" class="quarto-xref">Lemma&nbsp;<span>8.1</span></a>, any design <span class="math inline">\(\xi\)</span> must have at least one point of support <span class="math inline">\(\mathbf{x}_i\)</span> at which <span class="math inline">\(d(\mathbf{x}_i,\xi )\geq p\)</span>. Therefore <span class="math display">\[ \max _{\mathbf{x} \in \Omega }d(\mathbf{x} ,\xi ) \geq p \]</span> for all designs <span class="math inline">\(\xi\)</span>, and <span class="math inline">\(\xi^*\)</span> achieves the minimum value of the above maximum, this minimum value being <span class="math inline">\(p\)</span>.</p>
<p>So of the three parts of the statement of the theorem, we have shown that (1.) implies (2.) and (3.). We also know now that there exists at least one design <span class="math inline">\(\xi\)</span> for which <span class="math inline">\(\max_{\mathbf{x} \in \Omega }d(\mathbf{x},\xi )=p\)</span>, so that (2.) and (3.) are equivalent to each other. If we now take a design <span class="math inline">\(\xi^*\)</span> which satisfies (2.) or (3.), then, working backwards, we can conclude that, in the same notation as above, <span class="math display">\[\frac{\partial }{\partial \alpha }\ln |\mathbf{M} (\xi )||_{\alpha =0}
\leq 0 \]</span> for any choice of <span class="math inline">\(\xi_0\)</span>. This would be impossible if there were a choice of <span class="math inline">\(\xi_0\)</span> for which <span class="math inline">\(|\mathbf{M} (\xi_0)|&gt;|\mathbf{M} (\xi^*)|\)</span>, because of the concavity property of <a href="#lem-lemmaconcave" class="quarto-xref">Lemma&nbsp;<span>8.3</span></a>. Hence <span class="math inline">\(\xi^*\)</span> maximises <span class="math inline">\(|\mathbf{M} (\xi )|\)</span>, and (2.) and (3.) imply (1.). This concludes the proof of the theorem.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Designs for mixture experiments.html" class="pagination-link" aria-label="Designs for mixture experiments">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Designs for mixture experiments</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Tailor-made designs.html" class="pagination-link" aria-label="Tailor-made designs">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tailor-made designs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>