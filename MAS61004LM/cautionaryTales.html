<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Cautionary tales – A Second Course on Linear Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assumptions.html" rel="next">
<link href="./hypothesisTesting.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cautionaryTales.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Cautionary tales</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A Second Course on Linear Models</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basicconcepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basic concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parameterestimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Parameter estimation for linear models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qualitative.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Qualitative independent variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fitting-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fitting a linear model and making predictions in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesisTesting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cautionaryTales.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Cautionary tales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Checking model assumptions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Transformations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelSelection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Model Selection</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrixAlgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Matrix algebra essentials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./randomVectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Random vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariateNormal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">The multivariate normal distribution</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-multiplicity" id="toc-sec-multiplicity" class="nav-link active" data-scroll-target="#sec-multiplicity"><span class="header-section-number">6.1</span> Multiplicity</a>
  <ul class="collapse">
  <li><a href="#use-a-single-f-test" id="toc-use-a-single-f-test" class="nav-link" data-scroll-target="#use-a-single-f-test"><span class="header-section-number">6.1.1</span> Use a single <span class="math inline">\(F\)</span>-test</a></li>
  <li><a href="#adjusting-for-multiplicity" id="toc-adjusting-for-multiplicity" class="nav-link" data-scroll-target="#adjusting-for-multiplicity"><span class="header-section-number">6.1.2</span> Adjusting for multiplicity</a></li>
  </ul></li>
  <li><a href="#small-effect-sizes-significance-versus-importance" id="toc-small-effect-sizes-significance-versus-importance" class="nav-link" data-scroll-target="#small-effect-sizes-significance-versus-importance"><span class="header-section-number">6.2</span> Small effect sizes: significance versus importance</a></li>
  <li><a href="#sec-carquad" id="toc-sec-carquad" class="nav-link" data-scroll-target="#sec-carquad"><span class="header-section-number">6.3</span> Relationships between independent variables</a>
  <ul class="collapse">
  <li><a href="#correlations-between-estimators" id="toc-correlations-between-estimators" class="nav-link" data-scroll-target="#correlations-between-estimators"><span class="header-section-number">6.3.1</span> Correlations between estimators</a></li>
  </ul></li>
  <li><a href="#correlation-and-causality" id="toc-correlation-and-causality" class="nav-link" data-scroll-target="#correlation-and-causality"><span class="header-section-number">6.4</span> Correlation and causality</a>
  <ul class="collapse">
  <li><a href="#graphical-models" id="toc-graphical-models" class="nav-link" data-scroll-target="#graphical-models"><span class="header-section-number">6.4.1</span> Graphical models</a></li>
  <li><a href="#conditional-independence" id="toc-conditional-independence" class="nav-link" data-scroll-target="#conditional-independence"><span class="header-section-number">6.4.2</span> Conditional independence</a></li>
  <li><a href="#post-treatment-variables" id="toc-post-treatment-variables" class="nav-link" data-scroll-target="#post-treatment-variables"><span class="header-section-number">6.4.3</span> Post-treatment variables</a></li>
  </ul></li>
  <li><a href="#replication" id="toc-replication" class="nav-link" data-scroll-target="#replication"><span class="header-section-number">6.5</span> Replication</a></li>
  <li><a href="#chapter-appendix" id="toc-chapter-appendix" class="nav-link" data-scroll-target="#chapter-appendix"><span class="header-section-number">6.6</span> Chapter appendix</a>
  <ul class="collapse">
  <li><a href="#orthogonal-polynomials" id="toc-orthogonal-polynomials" class="nav-link" data-scroll-target="#orthogonal-polynomials"><span class="header-section-number">6.6.1</span> Orthogonal polynomials</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Cautionary tales</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter we will discuss some issues and problems that can arise with hypothesis testing, in particular:</p>
<ol type="1">
<li>problems with conducting a large number of tests in a single investigation;</li>
<li>correlations between parameter estimators and the consequences for tests;</li>
<li>correlation versus causation.</li>
</ol>
<section id="sec-multiplicity" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-multiplicity"><span class="header-section-number">6.1</span> Multiplicity</h2>
<p>Suppose we have a data set with a large number of independent variables, where the aim is to investigate whether any of them are associated with the dependent variable. For example, in a multiple regression model, <span class="math display">\[
Y_i=\beta_0+\beta_1 x_{i1}+\cdots+\beta_rx_{ir}+\varepsilon_i,
\]</span> we might perform <span class="math inline">\(r\)</span> separate tests of <span class="math inline">\(H_0:\beta_j=0\)</span> for each of <span class="math inline">\(j=1,\ldots,r\)</span>. The problem here is that the more tests we do, the higher the risk of falsely rejecting a null hypothesis, assuming the number of true nulls increases. We illustrate this with a simulation experiment, in which the true and fitted models are as follows: <span class="math display">\[\begin{align}
\mbox{True model: }Y_i &amp;= \beta_0 + \varepsilon_i,\\
\mbox{Fitted model: }Y_i &amp;= \beta_0 + \sum_{j=1}^{100} \beta_j x_{ij}+\varepsilon_i.
\end{align}\]</span></p>
<p>Given some data, we will test 100 separate hypotheses <span class="math inline">\(H_0:\beta_j=0\)</span> for each of <span class="math inline">\(j=1,\ldots,100\)</span>. By construction, we will know that <span class="math inline">\(H_0\)</span> is really true in each case, but for a test of size 0.05, we’d expect to reject the null hypothesis on 5 out of the 100 occasions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed for reproducibility</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">61004</span>) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and label the data. By construction, all columns are independent</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span><span class="sc">*</span><span class="dv">101</span>), <span class="dv">1000</span>, <span class="dv">101</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model will all 100 independent variables</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The Y ~ . notation is shorthand for this.</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>lmFull <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> . , df1)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the p-values of the 100 t-tests, and arrange in ascending order</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>cm1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">summary</span>(lmFull)<span class="sc">$</span>coefficients)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cm1)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"pvalue"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>cm1<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"beta"</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>cm1 <span class="sc">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pvalue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 101 × 5
   Estimate `Std. Error` `t value`   pvalue variable
      &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
 1   0.124        0.0328      3.77 0.000174 beta78  
 2   0.0823       0.0341      2.41 0.0160   beta36  
 3   0.0802       0.0335      2.39 0.0169   beta33  
 4  -0.0637       0.0342     -1.86 0.0629   beta47  
 5   0.0614       0.0331      1.85 0.0640   beta70  
 6   0.0592       0.0328      1.80 0.0718   beta68  
 7   0.0597       0.0335      1.78 0.0753   beta15  
 8  -0.0569       0.0322     -1.77 0.0776   beta71  
 9   0.0587       0.0341      1.72 0.0853   beta54  
10  -0.0558       0.0326     -1.71 0.0872   beta85  
# ℹ 91 more rows</code></pre>
</div>
</div>
<p>In the table above, we’ve arranged the <span class="math inline">\(p\)</span>-values in ascending order. We can see three <span class="math inline">\(p\)</span>-values below 0.05 (roughly what we would expect). In particular, the <span class="math inline">\(p\)</span>-value for the test <span class="math display">\[
H_0: \beta_{78}=0
\]</span> is 0.0002 to 4 d.p., which certainly gives the appearance of strong evidence against <span class="math inline">\(H_0\)</span>.</p>
<p>By construction, however, we know there is no relationship between any of the independent variables and the dependent variables. How can we guard against false results such as these? Two strategies are as follows.</p>
<section id="use-a-single-f-test" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="use-a-single-f-test"><span class="header-section-number">6.1.1</span> Use a single <span class="math inline">\(F\)</span>-test</h3>
<p>We need to consider the aim of the investigation. In the example above, we might suppose that the investigator was searching for <em>anything</em> associated with the dependent variable, from a large set of candidate variables. The investigator <em>didn’t</em> single out a particular variable (e.g.&nbsp;the <span class="math inline">\(x_{78}\)</span> variable) in advance of the experiment as the variable most likely to be associated with the dependent variable.</p>
<p>In this scenario, we might test the <em>single</em> hypothesis that <em>none</em> of the variables are associated with the dependent variable: <span class="math display">\[
H_0: \beta_1=\beta_2=\ldots=\beta_{100}=0,
\]</span> which we can test with an <span class="math inline">\(F\)</span>-test: we compare the full model above with a reduced model <span class="math display">\[
Y_i = \beta_0 + \varepsilon_i
\]</span> If we do this in R, we find that there is no evidence against <span class="math inline">\(H_0\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lmReduced <span class="ot">&lt;-</span><span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, df1)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lmReduced, lmFull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Y ~ 1
Model 2: Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 + X10 + X11 + 
    X12 + X13 + X14 + X15 + X16 + X17 + X18 + X19 + X20 + X21 + 
    X22 + X23 + X24 + X25 + X26 + X27 + X28 + X29 + X30 + X31 + 
    X32 + X33 + X34 + X35 + X36 + X37 + X38 + X39 + X40 + X41 + 
    X42 + X43 + X44 + X45 + X46 + X47 + X48 + X49 + X50 + X51 + 
    X52 + X53 + X54 + X55 + X56 + X57 + X58 + X59 + X60 + X61 + 
    X62 + X63 + X64 + X65 + X66 + X67 + X68 + X69 + X70 + X71 + 
    X72 + X73 + X74 + X75 + X76 + X77 + X78 + X79 + X80 + X81 + 
    X82 + X83 + X84 + X85 + X86 + X87 + X88 + X89 + X90 + X91 + 
    X92 + X93 + X94 + X95 + X96 + X97 + X98 + X99 + X100
  Res.Df    RSS  Df Sum of Sq      F  Pr(&gt;F)  
1    999 998.00                               
2    899 879.63 100    118.36 1.2097 0.08878 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="adjusting-for-multiplicity" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="adjusting-for-multiplicity"><span class="header-section-number">6.1.2</span> Adjusting for multiplicity</h3>
<p>We refer to collection of tests (such as testing <span class="math inline">\(H_0:\beta_i=0\)</span> separately for <span class="math inline">\(i=1,\ldots,100\)</span>) as a <em>family</em> of tests, and we consider <em>family-wise error rates</em>. The family-wise Type I error rate (FWER) would be the probability of falsely rejecting <em>any</em> null hypothesis within the family, out of all cases in which the null hypothesis is true.</p>
<p>The idea is to specify the FWER (e.g.&nbsp;at 0.05), and then adjust the size of each test within the family to achieve (or bound) the FWER. Two possible adjustments are as follows.</p>
<ol type="1">
<li><p><strong>Bonferroni correction</strong>. If we perform <span class="math inline">\(n\)</span> tests, and we desire a family-wise Type I error rate of <span class="math inline">\(\alpha\)</span>, we set the size of each individual test to be <span class="math inline">\(\alpha/n\)</span>.</p></li>
<li><p><strong>Šidák correction</strong>. If we perform <span class="math inline">\(n\)</span> tests, and we desire a family-wise Type I error rate of <span class="math inline">\(\alpha\)</span>, we set the size of each individual test to be <span class="math inline">\(\alpha^*:=1-(1-\alpha)^\frac{1}{n}\)</span>.</p></li>
</ol>
<p>Suppose the null hypothesis is true for all <span class="math inline">\(n\)</span> tests. For the Bonferroni correction, we have <span class="math display">\[
P(\mbox{reject at least one null}) \le \sum_{i=1}^n P(\mbox{reject null in $i$-th test}) = n\frac{\alpha}{n} = \alpha
\]</span> For the Šidák correction, <em>assuming the test outcomes are independent</em> <span class="math display">\[
P(\mbox{reject at least one null}) =1-P(\mbox{do not reject any null}) = 1-(1-\alpha^*)^n = \alpha
\]</span> Hence the Šidák correction gives an exact FWER of <span class="math inline">\(\alpha\)</span>, under an assumption of independent tests. The Bonferroni correction only given an upper bound for the FWER, but does not assume independent tests.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two corrections give very similar values. If you ever find that your result depends upon which you use, then I’d encourage you to consider the following quote from the mathematician Richard Hamming (which I think is relevant in many situations!)</p>
<p><em>“Does anyone believe that the difference between the Lebesgue and Riemann integrals can have physical significance, and that whether say, an airplane would or would not fly could depend on this difference? If such were claimed, I should not care to fly in that plane.”</em></p>
</div>
</div>
<p>In the example with 100 tests, for a target FWER of 0.05, we’d look for a <span class="math inline">\(p\)</span>-value smaller than 0.0005, and for a target FWER of 0.01, we’d look for a <span class="math inline">\(p\)</span>-value smaller than 0.0001. The smallest <span class="math inline">\(p\)</span>-value we observed was 0.00017, so we’d be more sceptical that we have found a genuine association.</p>
</section>
</section>
<section id="small-effect-sizes-significance-versus-importance" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="small-effect-sizes-significance-versus-importance"><span class="header-section-number">6.2</span> Small effect sizes: significance versus importance</h2>
<p>It’s important not to get too carried away with a significant result! The effect size may be too small for the result to have any practical importance. Continuing the example above, <span class="math inline">\(R^2_{adj}\)</span> is very small, about 2%:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmFull)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02055728</code></pre>
</div>
</div>
<p>and a scatter plot of the dependent variable against <span class="math inline">\(x_{78}\)</span> shows mostly random scatter and a relatively shallow gradient in the fitted line</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> X78, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-carquad" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-carquad"><span class="header-section-number">6.3</span> Relationships between independent variables</h2>
<p>Consider the following example using the <code>cars</code> data. We’d clearly expect there to be a relationship between speed and stopping distance, and it is visible in a scatter plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x =</span> speed, <span class="at">y =</span> dist)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now consider a quadratic regression model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lmQuad <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>), cars)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmQuad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dist ~ speed + I(speed^2), data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-28.720  -9.184  -3.188   4.628  45.152 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  2.47014   14.81716   0.167    0.868
speed        0.91329    2.03422   0.449    0.656
I(speed^2)   0.09996    0.06597   1.515    0.136

Residual standard error: 15.18 on 47 degrees of freedom
Multiple R-squared:  0.6673,    Adjusted R-squared:  0.6532 
F-statistic: 47.14 on 2 and 47 DF,  p-value: 5.852e-12</code></pre>
</div>
</div>
<p>The <code>F-statistic</code> shows strong evidence against a null model <span class="math inline">\(Y_i=\beta_0 + \varepsilon_i\)</span>, but in the <code>Coefficients</code> table, <em>neither</em> the coefficients for <code>speed</code> or <code>speed^2</code> are significant. What is going on here?</p>
<p>Our quadratic regression model is <span class="math display">\[
Y_i=\beta_0 + \beta_1x_i + \beta_2x_i^2+ \varepsilon_i.
\]</span></p>
<p>The issue here is the relationship between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_i^2\)</span>, which is quite close to linear for the given set of <span class="math inline">\(x_i\)</span> values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cars<span class="sc">$</span>speed, cars<span class="sc">$</span>speed<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9794765</code></pre>
</div>
</div>
<p>This means we have two columns in the design matrix <span class="math inline">\(X\)</span> that are close to being linearly dependent (sometimes referred to as <em>multicollinearity</em>). Intuitively, this suggests that, <em>for the purpose of explaining variation in the dependent variable</em>, we need at most one of <span class="math inline">\(x_i\)</span> or <span class="math inline">\(x_i^2\)</span> in our model, but not both: the two variables are, in effect, describing the same thing.</p>
<section id="correlations-between-estimators" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="correlations-between-estimators"><span class="header-section-number">6.3.1</span> Correlations between estimators</h3>
<p>Continuing the example, we have strong correlations between the estimators <span class="math inline">\(\hat{\beta}_0\)</span>, <span class="math inline">\(\hat{\beta}_1\)</span> and <span class="math inline">\(\hat{\beta}_2\)</span>, and it is helpful to understand what effect this has on model fitting and hypothesis testing.</p>
<p>Recall that <span class="math display">\[
Var(\hat{\boldsymbol{\beta}}) = \sigma^2(X^TX)^{-1}
\]</span> We can extract <span class="math inline">\(X\)</span> from R using the <code>model.matrix()</code> command (and we also use <code>cov2cor()</code> to convert a covariance matrix to a correlation matrix):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lmQuad)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov2cor</span>(<span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)      speed I(speed^2)
(Intercept)   1.0000000 -0.9605503  0.8929849
speed        -0.9605503  1.0000000 -0.9794765
I(speed^2)    0.8929849 -0.9794765  1.0000000</code></pre>
</div>
</div>
<p>The consequence of this is that adding/removing one term (e.g.&nbsp;the term corresponding to <span class="math inline">\(\beta_1\)</span>) will change the estimated coefficient(s) corresponding to the other term(s).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check this for yourself. Investigate what happens to the coefficients as terms are added or removed: try fitting models such as</p>
<pre><code>lm(dist ~ 1, cars)
lm(dist ~ speed, cars)
lm(dist ~ I(speed^2), cars)
lm(dist ~ speed + I(speed^2), cars)</code></pre>
<p>and comparing the estimated coefficients in each case.</p>
</div>
</div>
<p>This gives us another way to understand why the individual <span class="math inline">\(t\)</span>-tests were not significant. For example, if we consider a test of <span class="math inline">\(\beta_1=0\)</span>, we can think of this as a model comparison between <span class="math display">\[\begin{align}
\mbox{full model: }Y_i&amp;=\beta_0 + \beta_1x_i + \beta_2x_i^2+ \varepsilon_i,\\
\mbox{reduced model: }Y_i&amp;=\beta_0 + \beta_2x_i^2+ \varepsilon_i.
\end{align}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The fitted full model coefficients are obtained as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>), cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dist ~ speed + I(speed^2), data = cars)

Coefficients:
(Intercept)        speed   I(speed^2)  
    2.47014      0.91329      0.09996  </code></pre>
</div>
</div>
<p>In comparing the full and reduced model, we are <strong>not</strong> comparing <span class="math display">\[\begin{align}
\mbox{full model: }Y_i&amp;=2.47 + 0.91x_i + 0.10x_i^2+ \varepsilon_i,\\
\mbox{reduced model: }Y_i&amp;=2.47 + 0.10x_i^2+ \varepsilon_i.
\end{align}\]</span> When we fit the reduced model to the data, the estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_2\)</span> will change, because of the correlation between the least squares estimators. In this case, the fact that the estimate change result in the reduced model fitting nearly as well as the full model. We can see this by noting the residual sum of squares for each model in the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lmReduced <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>), cars)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lmReduced, lmQuad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: dist ~ I(speed^2)
Model 2: dist ~ speed + I(speed^2)
  Res.Df   RSS Df Sum of Sq      F Pr(&gt;F)
1     48 10871                           
2     47 10825  1    46.423 0.2016 0.6555</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<div id="exr-wrong-fitted-values" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 6.1</strong></span> In the example above, suppose the reduced model <em>was</em> fitted simply by setting <span class="math inline">\(\hat{\beta}_1=0\)</span> in the full model; the other parameter estimates don’t change. In R, <code>lmQuad$fitted.values</code> will extract the fitted values for the full model. Compare the residual sum of squares for the two models, if the reduced model was fitted in this way.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In this case, we subtract <span class="math inline">\(\hat{\beta}_1x_i\)</span> from the <span class="math inline">\(i\)</span>-th fitted value in the full model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>yhatWrong <span class="ot">&lt;-</span> lmQuad<span class="sc">$</span>fitted.values <span class="sc">-</span> <span class="fl">0.91329</span> <span class="sc">*</span> cars<span class="sc">$</span>speed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using these ‘wrong’ fitted values, the residual sum of squares would be</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((yhatWrong <span class="sc">-</span> cars<span class="sc">$</span>dist)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21858.17</code></pre>
</div>
</div>
<p>which is about double the residual sum of squares for the full model.</p>
</div>
</div>
</div>
<p>For designed experiments (where we can choose the dependent variable values), it can be desirable to aim for <em>orthogonal</em> columns in the design matrix, such that parameter estimators are independent, making it easier to isolate the effect of individual variables. (much more on this in the Sampling and Design module). In this particular example, we could make use of <em>orthogonal polynomials</em>. This is outside the scope of this model, but there is brief discussion in the Chapter appendix for anyone interested.</p>
</section>
</section>
<section id="correlation-and-causality" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="correlation-and-causality"><span class="header-section-number">6.4</span> Correlation and causality</h2>
<p>You have probably heard the phase “correlation is not the same as causation”. The classic example of this is the scenario of increasing temperatures causing both an increase in ice-cream sales, and an increase in violent crime (through increased alcohol consumption). If we examine ice-cream sales and violent crime together, we might observe correlation between them, but we wouldn’t believe this to be a causal relationship.</p>
<p>Causal inference is an interesting and active research topic, and connects in an intuitive way with linear modelling. A good introduction is given in</p>
<ul>
<li><a href="https://find.shef.ac.uk/permalink/f/15enftp/44SFD_ALMA_DS51357658150001441">Pearl, J., Glymour, M. and Jewell, N.P.</a> (2016) Causal inference in statistics: a primer. West Sussex, England: Wiley. (Ebook available from the library)</li>
</ul>
<p>We will give a very short discussion here, in the context of hypothesis tests (and parameter estimation) for linear models.</p>
<section id="graphical-models" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="graphical-models"><span class="header-section-number">6.4.1</span> Graphical models</h3>
<p>It can be helpful to represent relationships between variables using graphs, with nodes representing variables and directed edges between nodes representing causal relationships.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">"dag{ IC &lt;- Temp -&gt; Crime}"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>( dag ) <span class="ot">&lt;-</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>( <span class="at">x=</span><span class="fu">c</span>(<span class="at">Temp =</span> <span class="dv">1</span>, <span class="at">IC =</span> <span class="dv">0</span>, <span class="at">Crime =</span> <span class="dv">2</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="fu">c</span>(<span class="at">Temp =</span> <span class="dv">1</span>, <span class="at">IC =</span> <span class="dv">0</span>, <span class="at">Crime =</span> <span class="dv">0</span>) )</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(dag) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this plot the arrow going from <code>Temp</code> (temperature) to <code>IC</code> (ice cream sales) represents a causal relationship: the volume of ice cream sales is ‘caused’ by the value of the temperature, and potentially other unmeasured variables represented by an error term, e.g.&nbsp;<span class="math display">\[
IC_i = \beta_0 + \beta_1Temp_i + \varepsilon_i.
\]</span> The diagram represents a similar causal relationship between temperature and crime, but no causal relationship between ice creams sales and crime. Ice creams sales and crime are correlated, however, due to their common dependence on temperature.</p>
<p>We’ll now consider a few examples of causal relationships versus correlations, and how they might be explored through hypothesis tests.</p>
</section>
<section id="conditional-independence" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="conditional-independence"><span class="header-section-number">6.4.2</span> Conditional independence</h3>
<p>In the ice cream example, we might expect ice cream sales and crime to be independent <em>conditional</em> on temperature (the idea of conditional independence is developed more formally in the Bayesian statistics module).</p>
<p>In general, suppose we have three random variables: <span class="math inline">\(X, Y\)</span> and <span class="math inline">\(Z\)</span>, where both <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span> are dependent on <span class="math inline">\(X\)</span>, but conditionally independent given the value of <span class="math inline">\(X\)</span>. We visualise this as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As an example, suppose that the true ‘causal’ relationships between the variables are given by <span class="math display">\[\begin{align}
Y_i &amp;= \beta_0 + \beta_1 X_i + \varepsilon_i,\\
Z_i &amp;= \alpha_0 + \alpha_1 X_i + \delta_i,\\
\end{align}\]</span> where <span class="math inline">\(\varepsilon_i\)</span> and <span class="math inline">\(\delta_i\)</span> are random error terms. We’ll first generate some random data in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">61004</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we try a simple linear regression model of <span class="math inline">\(Y\)</span> on <span class="math inline">\(Z\)</span>, we would detect a relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lmYonZ <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>  z)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmYonZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ z)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.3232 -0.8955 -0.1176  0.8613  3.2355 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.010668   0.291562   0.037    0.971    
z           0.999672   0.005003 199.811   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.449 on 98 degrees of freedom
Multiple R-squared:  0.9976,    Adjusted R-squared:  0.9975 
F-statistic: 3.992e+04 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>However, if we include the variable <span class="math inline">\(X\)</span> in our model, the evidence for a relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span> disappears:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lmYonXandZ <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>  x <span class="sc">+</span> z)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmYonXandZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x + z)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.55853 -0.53880  0.09033  0.58057  2.75507 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.11805    0.19322  -0.611    0.543    
x            1.09501    0.09720  11.266   &lt;2e-16 ***
z           -0.09123    0.09689  -0.942    0.349    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9585 on 97 degrees of freedom
Multiple R-squared:  0.9989,    Adjusted R-squared:  0.9989 
F-statistic: 4.567e+04 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If we want to investigate the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span>, and suspect they are both dependent on a third variable <span class="math inline">\(X\)</span>, we should <em>adjust</em> for that variable in our modelling: we include <span class="math inline">\(X\)</span> as in independent variable in the model, and then see whether including <span class="math inline">\(Z\)</span> as an <em>additional</em> independent variable improves our ability to predict <span class="math inline">\(Y\)</span>.</p>
</div>
</div>
</section>
<section id="post-treatment-variables" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="post-treatment-variables"><span class="header-section-number">6.4.3</span> Post-treatment variables</h3>
<p>A different scenario is where we a variable <span class="math inline">\(X\)</span> has a causal effect on our dependent variable <span class="math inline">\(Y\)</span>, and the dependent variable <span class="math inline">\(Y\)</span> has a causal effect on some other quantity <span class="math inline">\(Z\)</span>. For example, for an individual exercise (<span class="math inline">\(X\)</span>) might cause weight loss (<span class="math inline">\(Y\)</span>), which might then result in a cholesterol reduction (<span class="math inline">\(Z\)</span>). We would refer to cholesterol reduction as a <em>post-treatment variable</em> in that it isn’t determined until after the treatment <span class="math inline">\(X\)</span> has been applied and the effect on <span class="math inline">\(Y\)</span> determined. The graphical representation would be as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This has implications for what should be included in a model. We suppose that the true ‘causal’ relationships between the variables are given by <span class="math display">\[\begin{align}
Y_i &amp;= \beta_0 + \beta_1 X_i + \varepsilon_i,\\
Z_i &amp;= \alpha_0 + \alpha_1 Y_i + \delta_i,\\
\end{align}\]</span> where <span class="math inline">\(\varepsilon_i\)</span> and <span class="math inline">\(\delta_i\)</span> are random error terms. We’ll first generate some random data in R (with <span class="math inline">\(\beta_0=0\)</span> and <span class="math inline">\(\beta_1=1\)</span>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">61004</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> y <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A simple linear regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span> will give estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> close to their true values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lmYonX <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>  x)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmYonX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5438 -0.5781  0.0856  0.6364  2.6931 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.10914    0.19015  -0.574    0.567    
x            1.03513    0.03285  31.508   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9579 on 98 degrees of freedom
Multiple R-squared:  0.9102,    Adjusted R-squared:  0.9092 
F-statistic: 992.7 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Now observe how including the post-treatment variable <span class="math inline">\(Z\)</span> in the model changes the estimated effect of the treatment <span class="math inline">\(X\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>lmYonXandZ <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>  x <span class="sc">+</span> z)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmYonXandZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x + z)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.64776 -0.47647 -0.03676  0.38458  1.62566 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.03031    0.14468  -0.209    0.835    
x            0.52946    0.06423   8.243 8.17e-13 ***
z            0.47666    0.05580   8.543 1.86e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7273 on 97 degrees of freedom
Multiple R-squared:  0.9487,    Adjusted R-squared:  0.9477 
F-statistic: 897.4 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Including the post-treatment variable in the regression model <em>changes the objective of the regression model</em>: the implied objective is to find the best prediction of <span class="math inline">\(Y\)</span> given both <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>, not to reveal the causal relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\((X,Z)\)</span>. If the real purpose is to predict <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> only, we should <em>not</em> include <span class="math inline">\(Z\)</span> in the model.</p>
</div>
</div>
</section>
</section>
<section id="replication" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="replication"><span class="header-section-number">6.5</span> Replication</h2>
<p>Although outside the scope of what we can do in this module, it is important to consider replicating any study to see if the same result is obtained. The replicability of scientific findings is itself now an active area of research. See for example</p>
<ul>
<li><p><a href="https://doi.org/10.1038/s41562-018-0399-z">Camerer, C.F., Dreber, A., Holzmeister, F. et al.&nbsp;(2018)</a> Evaluating the replicability of social science experiments in Nature and Science between 2010 and 2015. Nat Hum Behav 2, 637–644 . https://doi.org/10.1038/s41562-018-0399-z</p></li>
<li><p><a href="https://doi.org/10.1371/journal.pmed.0020124">Ioannidis J.P.A. (2005)</a> Why Most Published Research Findings Are False. PLoS Med 2(8): e124. https://doi.org/10.1371/journal.pmed.0020124 pmid:16060722]</p></li>
</ul>
<p>In clinical trials for new medicines, regulators such as the US Food and Drug Administration and the European Medicines Agency may require <em>two</em> (Phase III) studies demonstrating the effectiveness of a drug.</p>
</section>
<section id="chapter-appendix" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="chapter-appendix"><span class="header-section-number">6.6</span> Chapter appendix</h2>
<p>The following topic is outside the scope of this module, but is included for interest.</p>
<section id="orthogonal-polynomials" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="orthogonal-polynomials"><span class="header-section-number">6.6.1</span> Orthogonal polynomials</h3>
<p>In the example in <a href="#sec-carquad" class="quarto-xref"><span>Section 6.3</span></a>, we can use <em>orthogonal polynomials</em>. The idea is to use Gram-Schmidt orthogonalisation to transform the columns of the design matrix <span class="math inline">\(X\)</span> to set of linearly independent (orthogonal) columns. This makes the coefficients harder to interpret, but it is then possible to isolate a quadratic effect, if we were interested in testing for it. (It can also improve numerical stability of the results.)</p>
<p>We use the <code>poly()</code> command to set up orthogonal polynomials. We’ll compare quadratic regression models using both raw and orthogonal polynomials</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using raw polynomials</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>lmRaw <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>), cars)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using orthogonal polynomials</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>lmOrthogonal <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> <span class="fu">poly</span>(speed, <span class="at">degree =</span> <span class="dv">2</span>), cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmRaw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dist ~ speed + I(speed^2), data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-28.720  -9.184  -3.188   4.628  45.152 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  2.47014   14.81716   0.167    0.868
speed        0.91329    2.03422   0.449    0.656
I(speed^2)   0.09996    0.06597   1.515    0.136

Residual standard error: 15.18 on 47 degrees of freedom
Multiple R-squared:  0.6673,    Adjusted R-squared:  0.6532 
F-statistic: 47.14 on 2 and 47 DF,  p-value: 5.852e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmOrthogonal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dist ~ poly(speed, degree = 2), data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-28.720  -9.184  -3.188   4.628  45.152 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                42.980      2.146  20.026  &lt; 2e-16 ***
poly(speed, degree = 2)1  145.552     15.176   9.591 1.21e-12 ***
poly(speed, degree = 2)2   22.996     15.176   1.515    0.136    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.18 on 47 degrees of freedom
Multiple R-squared:  0.6673,    Adjusted R-squared:  0.6532 
F-statistic: 47.14 on 2 and 47 DF,  p-value: 5.852e-12</code></pre>
</div>
</div>
<p>Note that the residual standard error and <span class="math inline">\(R^2\)</span> statistics are the same for both versions: switching to orthogonal polynomials doesn’t improve the model fit. But in the orthogonal case, we see that the linear term is significant; the quadratic term is not.</p>
<p>We’ll extract the design matrix for each:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>Xraw <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lmRaw)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>XOrthogonal <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(lmOrthogonal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and compare the variance-covariance matrices (<span class="math inline">\(\sigma^2(X^TX)^{-1}\)</span>) for each:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(Xraw)<span class="sc">%*%</span> Xraw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)      speed I(speed^2)
(Intercept)     0.95326 -0.1257085  0.0037899
speed          -0.12571  0.0179671 -0.0005707
I(speed^2)      0.00379 -0.0005707  0.0000189</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(XOrthogonal)<span class="sc">%*%</span> XOrthogonal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         (Intercept) poly(speed, degree = 2)1
(Intercept)                2.000e-02               -2.776e-17
poly(speed, degree = 2)1  -2.776e-17                1.000e+00
poly(speed, degree = 2)2  -2.109e-17                2.352e-17
                         poly(speed, degree = 2)2
(Intercept)                            -2.109e-17
poly(speed, degree = 2)1                2.352e-17
poly(speed, degree = 2)2                1.000e+00</code></pre>
</div>
</div>
<p>Note that the off-diagonal elements in the orthogonal polynomial model are all very close to 0 (rounding errors): the parameter estimators are all independent. Finally, to help visualise the quadratic term using orthogonal polynomials, we’ll plot the third column of the design matrix <span class="math inline">\(X\)</span> each model against <code>speed</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars<span class="sc">$</span>speed, Xraw[, <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cars<span class="sc">$</span>speed, XOrthogonal[, <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cautionaryTales_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./hypothesisTesting.html" class="pagination-link" aria-label="Hypothesis testing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assumptions.html" class="pagination-link" aria-label="Checking model assumptions">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Checking model assumptions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>