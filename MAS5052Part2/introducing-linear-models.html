<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Introducing linear models | MAS5052 Part 2: Likelihood and Linear Models</title>
  <meta name="description" content="Lecture notes for MAS5052" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Introducing linear models | MAS5052 Part 2: Likelihood and Linear Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Lecture notes for MAS5052" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Introducing linear models | MAS5052 Part 2: Likelihood and Linear Models" />
  
  <meta name="twitter:description" content="Lecture notes for MAS5052" />
  

<meta name="author" content="Jeremy Oakley" />


<meta name="date" content="2022-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="likelihood-for-confidence-intervals-and-hypothesis-tests.html"/>
<link rel="next" href="parameter-estimation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MAS5052 Part 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About these notes</a></li>
<li class="part"><span><b>I Likelihood methods</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducing likelihood methods</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#recap-maximising-functions"><i class="fa fa-check"></i><b>1.1</b> Recap: maximising functions</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#maximum-likelihood-estimation-a-first-example"><i class="fa fa-check"></i><b>1.2</b> Maximum likelihood estimation: a first example</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducing-the-likelihood-function.html"><a href="introducing-the-likelihood-function.html"><i class="fa fa-check"></i><b>2</b> Introducing the likelihood function</a></li>
<li class="chapter" data-level="3" data-path="models-and-data.html"><a href="models-and-data.html"><i class="fa fa-check"></i><b>3</b> Models and data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="models-and-data.html"><a href="models-and-data.html#data-notation"><i class="fa fa-check"></i><b>3.1</b> Data: notation</a></li>
<li class="chapter" data-level="3.2" data-path="models-and-data.html"><a href="models-and-data.html#models-and-parameters"><i class="fa fa-check"></i><b>3.2</b> Models and parameters</a></li>
<li class="chapter" data-level="3.3" data-path="models-and-data.html"><a href="models-and-data.html#likelihood-functions-for-i.i.d-data"><i class="fa fa-check"></i><b>3.3</b> Likelihood functions for i.i.d data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="maximisation-techniques.html"><a href="maximisation-techniques.html"><i class="fa fa-check"></i><b>4</b> Maximisation techniques</a>
<ul>
<li class="chapter" data-level="4.1" data-path="maximisation-techniques.html"><a href="maximisation-techniques.html#log-likelihood"><i class="fa fa-check"></i><b>4.1</b> Log-likelihood</a></li>
<li class="chapter" data-level="4.2" data-path="maximisation-techniques.html"><a href="maximisation-techniques.html#discrete-parameters"><i class="fa fa-check"></i><b>4.2</b> Discrete parameters</a></li>
<li class="chapter" data-level="4.3" data-path="maximisation-techniques.html"><a href="maximisation-techniques.html#multi-parameter-problems"><i class="fa fa-check"></i><b>4.3</b> Multi-parameter problems</a></li>
<li class="chapter" data-level="4.4" data-path="maximisation-techniques.html"><a href="maximisation-techniques.html#using-a-computer"><i class="fa fa-check"></i><b>4.4</b> Using a computer</a></li>
<li class="chapter" data-level="4.5" data-path="maximisation-techniques.html"><a href="maximisation-techniques.html#a-warning-example"><i class="fa fa-check"></i><b>4.5</b> A warning example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><i class="fa fa-check"></i><b>5</b> Likelihood for confidence intervals and hypothesis tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html#confidence-intervals"><i class="fa fa-check"></i><b>5.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="5.2" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html#hypothesis-tests"><i class="fa fa-check"></i><b>5.2</b> Hypothesis tests</a></li>
<li class="chapter" data-level="5.3" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html#a-more-formal-approach"><i class="fa fa-check"></i><b>5.3</b> A more formal approach</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html#asymptotic-normality-of-the-maximum-likelihood-estimator"><i class="fa fa-check"></i><b>5.3.1</b> Asymptotic normality of the maximum likelihood estimator</a></li>
<li class="chapter" data-level="5.3.2" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html#confidence-intervals-based-on-asymptotic-normality"><i class="fa fa-check"></i><b>5.3.2</b> Confidence intervals based on asymptotic normality</a></li>
<li class="chapter" data-level="5.3.3" data-path="likelihood-for-confidence-intervals-and-hypothesis-tests.html"><a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html#the-generalised-likelihood-ratio-test"><i class="fa fa-check"></i><b>5.3.3</b> The generalised likelihood ratio test</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Linear Models</b></span></li>
<li class="chapter" data-level="6" data-path="introducing-linear-models.html"><a href="introducing-linear-models.html"><i class="fa fa-check"></i><b>6</b> Introducing linear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introducing-linear-models.html"><a href="introducing-linear-models.html#example-relationship-between-temperature-and-ozone"><i class="fa fa-check"></i><b>6.1</b> Example: relationship between temperature and ozone</a></li>
<li class="chapter" data-level="6.2" data-path="introducing-linear-models.html"><a href="introducing-linear-models.html#notation-and-terminology"><i class="fa fa-check"></i><b>6.2</b> Notation and terminology</a></li>
<li class="chapter" data-level="6.3" data-path="introducing-linear-models.html"><a href="introducing-linear-models.html#example-suspected-electoral-fraud"><i class="fa fa-check"></i><b>6.3</b> Example: suspected electoral fraud</a></li>
<li class="chapter" data-level="6.4" data-path="introducing-linear-models.html"><a href="introducing-linear-models.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>6.4</b> Definition of a linear model</a></li>
<li class="chapter" data-level="6.5" data-path="introducing-linear-models.html"><a href="introducing-linear-models.html#the-simple-linear-regression-model"><i class="fa fa-check"></i><b>6.5</b> The simple linear regression model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>7</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="parameter-estimation.html"><a href="parameter-estimation.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.1</b> Least squares estimation</a></li>
<li class="chapter" data-level="7.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html#assumptions-for-least-squares"><i class="fa fa-check"></i><b>7.2</b> Assumptions for least squares</a></li>
<li class="chapter" data-level="7.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html#relationship-with-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>7.3</b> Relationship with maximum likelihood estimation</a></li>
<li class="chapter" data-level="7.4" data-path="parameter-estimation.html"><a href="parameter-estimation.html#estimating-sigma2"><i class="fa fa-check"></i><b>7.4</b> Estimating <span class="math inline">\(\sigma^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="matrix-notation-for-linear-models.html"><a href="matrix-notation-for-linear-models.html"><i class="fa fa-check"></i><b>8</b> Matrix notation for linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="matrix-notation-for-linear-models.html"><a href="matrix-notation-for-linear-models.html#least-squares-estimates-in-matrix-form"><i class="fa fa-check"></i><b>8.1</b> Least squares estimates in matrix form</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="matrix-notation-for-linear-models.html"><a href="matrix-notation-for-linear-models.html#example-fitting-a-polynomial-regression-model"><i class="fa fa-check"></i><b>8.1.1</b> Example: fitting a polynomial regression model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="matrix-notation-for-linear-models.html"><a href="matrix-notation-for-linear-models.html#estimate-of-sigma2-in-matrix-form"><i class="fa fa-check"></i><b>8.2</b> Estimate of <span class="math inline">\(\sigma^2\)</span> in matrix form</a></li>
<li class="chapter" data-level="8.3" data-path="matrix-notation-for-linear-models.html"><a href="matrix-notation-for-linear-models.html#derivation-of-hatbeta"><i class="fa fa-check"></i><b>8.3</b> Derivation of <span class="math inline">\(\hat{\beta}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fitting-a-linear-model-in-r.html"><a href="fitting-a-linear-model-in-r.html"><i class="fa fa-check"></i><b>9</b> Fitting a linear model in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="fitting-a-linear-model-in-r.html"><a href="fitting-a-linear-model-in-r.html#plotting-a-fitted-regression-line"><i class="fa fa-check"></i><b>9.1</b> Plotting a fitted regression line</a></li>
<li class="chapter" data-level="9.2" data-path="fitting-a-linear-model-in-r.html"><a href="fitting-a-linear-model-in-r.html#the-summary-command"><i class="fa fa-check"></i><b>9.2</b> The <code>summary()</code> command</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html"><i class="fa fa-check"></i><b>10</b> Qualitative independent variables</a>
<ul>
<li class="chapter" data-level="10.1" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#example-cancer-survival-data"><i class="fa fa-check"></i><b>10.1</b> Example: cancer survival data</a></li>
<li class="chapter" data-level="10.2" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#a-linear-model-for-the-cancer-data"><i class="fa fa-check"></i><b>10.2</b> A linear model for the cancer data</a></li>
<li class="chapter" data-level="10.3" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#notation-for-qualitative-independent-variables"><i class="fa fa-check"></i><b>10.3</b> Notation for qualitative independent variables</a></li>
<li class="chapter" data-level="10.4" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#the-one-way-anova-model-in-matrix-form"><i class="fa fa-check"></i><b>10.4</b> The one-way ANOVA model in matrix form</a></li>
<li class="chapter" data-level="10.5" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#least-squares-estimates-for-the-one-way-anova-model"><i class="fa fa-check"></i><b>10.5</b> Least squares estimates for the one-way ANOVA model</a></li>
<li class="chapter" data-level="10.6" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#fitting-a-one-way-anova-model-in-r"><i class="fa fa-check"></i><b>10.6</b> Fitting a one-way ANOVA model in R</a></li>
<li class="chapter" data-level="10.7" data-path="qualitative-independent-variables.html"><a href="qualitative-independent-variables.html#an-alternative-parameterisation"><i class="fa fa-check"></i><b>10.7</b> An alternative parameterisation</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multiple-independent-variables.html"><a href="multiple-independent-variables.html"><i class="fa fa-check"></i><b>11</b> Multiple independent variables</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multiple-independent-variables.html"><a href="multiple-independent-variables.html#causation-versus-association"><i class="fa fa-check"></i><b>11.1</b> Causation versus association</a></li>
<li class="chapter" data-level="11.2" data-path="multiple-independent-variables.html"><a href="multiple-independent-variables.html#analysis-of-covariance"><i class="fa fa-check"></i><b>11.2</b> Analysis of Covariance</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="using-linear-models-for-prediction.html"><a href="using-linear-models-for-prediction.html"><i class="fa fa-check"></i><b>12</b> Using linear models for prediction</a>
<ul>
<li class="chapter" data-level="12.1" data-path="using-linear-models-for-prediction.html"><a href="using-linear-models-for-prediction.html#obtaining-predictions-in-r"><i class="fa fa-check"></i><b>12.1</b> Obtaining predictions in R</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MAS5052 Part 2: Likelihood and Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introducing-linear-models" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Introducing linear models<a href="introducing-linear-models.html#introducing-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold");
  $folds.wrapInner("<div class=\"fold-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-btn\">Show solution</button>");  // add a button
  $(".fold-blck").toggle();  // fold all blocks
  $(".fold-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Show solution" ? "Hide solution" : "Show solution");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>
<p>In this part of the module, we will study how to use statistical models to learn about relationships between different variables, using a class of models known as <strong>linear models</strong>.</p>
<div class="rmdnote" latex-info="">
<p>The aim here is to teach you practical skills in linear modelling, so that you can fit linear models for a variety of different types of datasets, interpret the results, and make predictions. However, there are some important topics such as hypothesis testing and model checking that we will not cover here, but are taught on the MSc.</p>
</div>
<div id="example-relationship-between-temperature-and-ozone" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Example: relationship between temperature and ozone<a href="introducing-linear-models.html#example-relationship-between-temperature-and-ozone" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data set <code>airquality</code> (one of R’s built-in data sets) includes daily readings of temperature (degrees F) and ozone concentration (parts per billion), taken in New York<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. For more details, use the command</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introducing-linear-models.html#cb2-1" aria-hidden="true" tabindex="-1"></a>?airquality</span></code></pre></div>
<p>Some rows from the data set and a plot are shown below. Note that some rows have missing values - we will ignore these.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="introducing-linear-models.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="introducing-linear-models.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(<span class="at">x =</span> Temp, <span class="at">y =</span> Ozone))<span class="sc">+</span></span>
<span id="cb5-2"><a href="introducing-linear-models.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="MAS5052-Part2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>In the data, we see that we some observations have identical (recorded) temperature values, but different ozone values Hence given the temperature, we are not able to say with certainty what the
ozone concentration will be.</p>
<p>For observation <span class="math inline">\(i\)</span> let <span class="math inline">\(x_i\)</span> denote the recorded temperature and <span class="math inline">\(y_i\)</span>
denote the corresponding ozone concentration. If we think of <span class="math inline">\(y_i\)</span> as the <em>observed</em> value of a random variable <span class="math inline">\(Y_i\)</span>, we can then consider a
statistical model of the form
<span class="math display">\[
Y_i=f(x_i) + \varepsilon_i.
\]</span>
We typically choose <span class="math inline">\(f\)</span> to be some fairly simple function of <span class="math inline">\(x\)</span>
such as <span class="math inline">\(f(x)=\beta_0 +\beta_1 x\)</span> or <span class="math inline">\(f(x)=\beta_0+\beta_1 x+\beta_2 x^2\)</span>. The term <span class="math inline">\(\varepsilon_i\)</span> is a <em>random</em> “error.” Two
reasons why an error term would be necessary are as follows.</p>
<ol style="list-style-type: decimal">
<li><p>The variable <span class="math inline">\(x_i\)</span> is not sufficient for predicting <span class="math inline">\(Y_i\)</span> with
certainty. The variable <span class="math inline">\(Y_i\)</span> may also depend on other variables
which are unknown to us, or there may simply be variation in the
population that we are not able to explain with the function <span class="math inline">\(f\)</span>.</p></li>
<li><p>We are not able to observe the quantity we are interested in (e.g. ozone concentration) with absolute precision.
We observe instead the sum of the true value and a random
‘measurement error’ <span class="math inline">\(\varepsilon_i\)</span>.</p></li>
</ol>
<p>We further assume that <span class="math inline">\(\varepsilon_1,\ldots,\varepsilon_n\)</span> are
i.i.d (independent and identically distributed) with some
probability distribution, so that in our model, two observations with the same temperature may have different ozone concentrations.</p>
</div>
<div id="notation-and-terminology" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Notation and terminology<a href="introducing-linear-models.html#notation-and-terminology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Continuing the example, suppose we choose <span class="math inline">\(f(x)=\beta_0 + \beta_1 x\)</span>, so that we have
<span class="math display">\[\begin{equation}
Y_i=\beta_0+\beta_1 x_i +\varepsilon_i
\end{equation}\]</span>
We call the <span class="math inline">\(x\)</span>-variable (temperature) the <strong>independent</strong> or
<strong>regressor</strong> variable. <strong>We will always treat the
independent variable as a known constant</strong>. (In the example, one could think of the temperature, or at least recorded with some error. Nevertheless, in this modelling framework, the temperatures are treated as known, fixed values.)</p>
<p>The <span class="math inline">\(Y\)</span>-variable
(ozone concentration) is called the <strong>dependent</strong> variable.</p>
<p><strong>The dependent variable is treated as a random variable</strong>, as
it is expressed as a function of the independent variable plus a
random error term.</p>
<p>The dependent variable will always be a scalar,
but we will sometimes consider vector independent variables (e.g.
temperature and wind speed). We write <span class="math inline">\(\mathbf{x}\)</span> to denote a vector
independent variable.</p>
<p>Throughout this course we will always make the same assumption
that <span class="math inline">\(\varepsilon_i \sim N(0,\sigma^2)\)</span>, with
<span class="math inline">\(\varepsilon_1,\varepsilon_2,\ldots\)</span> independent. We will need to check this assumption, in particular, that each error has the same variance.</p>
<p>The <strong>parameters</strong> in this model are <span class="math inline">\(\beta_0, \beta_1\)</span> and
<span class="math inline">\(\sigma^2\)</span>. These model parameters are treated as unknown constants.
Note that since <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown, given <span class="math inline">\(x_i\)</span> and
<span class="math inline">\(y_i\)</span> we will still not know the true value of <span class="math inline">\(\varepsilon_i\)</span>.</p>
</div>
<div id="example-suspected-electoral-fraud" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Example: suspected electoral fraud<a href="introducing-linear-models.html#example-suspected-electoral-fraud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In 1993 the election for Pennsylvania’s Second State Senatorial
District, Philadelphia, was contested between Republican Marks and
Democrat Stinson. Marks received many more machine votes (votes cast
in polling booths), but Stinson received many more absentee ballot
votes (postal votes), narrowly edging a victory as a result. There
were suspicions about the authenticity of many of the absentee
ballots, however, and the case ended up in court.</p>
<p>The expert witness
hired by the judge considered the records of twenty-one previous
elections in Philadelphia’s senatorial districts, and looked at the
relationship between the difference in machine ballot votes and
difference in absentee ballot votes between Democrat and Republican
candidates. In the 1993 election, the difference in machine ballot
votes (Democrat - Republican) was -564 votes. The difference in
absentee ballot votes (Democrat - Republican) was 1025 votes. The
data are in the file <code>election.csv</code>, and are plotted below.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="introducing-linear-models.html#cb6-1" aria-hidden="true" tabindex="-1"></a>election <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;election.csv&quot;</span>)</span>
<span id="cb6-2"><a href="introducing-linear-models.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(election)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   absentee.diff machine.diff
##           &lt;dbl&gt;        &lt;dbl&gt;
## 1           346        26427
## 2           282        15904
## 3           223        42448
## 4           593        19444
## 5           572        71797
## 6          -229        -1017</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="introducing-linear-models.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(election, <span class="fu">aes</span>(<span class="at">x =</span> machine.diff, <span class="at">y =</span> absentee.diff)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="introducing-linear-models.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="introducing-linear-models.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">564</span>, <span class="at">y =</span> <span class="dv">1025</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb8-4"><a href="introducing-linear-models.html#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="introducing-linear-models.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">564</span>, <span class="at">y =</span> <span class="dv">1150</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb8-6"><a href="introducing-linear-models.html#cb8-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;disputed election&quot;</span>)</span></code></pre></div>
<p><img src="MAS5052-Part2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The scatter plot shows a clear relationship between difference
in machine votes and difference in absentee votes. Additionally, the
result in question is not consistent with the rest (i.e. it is an
<strong>outlier</strong>). However, we see that there is a second
(presumably undisputed) election result (44425,1329) that also
appears to be outlying. Do these data really suggest fraud? Is it
plausible that the observation (-564,1025) is simply due to chance? How can linear modelling be used to investigate this?</p>
</div>
<div id="definition-of-a-linear-model" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Definition of a linear model<a href="introducing-linear-models.html#definition-of-a-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One may imagine that a linear model means a ‘straight line’ (linear) relationship between the independent variable <span class="math inline">\(x\)</span> and dependent variable <span class="math inline">\(y\)</span>", but that is actually <em>not</em> the definition.</p>
<p>A linear model is defined to be any
model in which the expected value of the dependent variable <span class="math inline">\(E(Y_i)\)</span> is
expressed as a <strong>linear combination</strong> of the
<strong>parameters</strong></p>
<p>The following is an example of a linear model:
<span class="math display">\[
E(Y_i)=\beta_0+\beta_1 x_i.
\]</span></p>
<p>Is the model
<span class="math display">\[
E(Y_i)=\beta_0+\beta_1 x_i+ \beta_2 x_i^2 
\]</span>
a linear model? Yes, because <span class="math inline">\(E(Y_i)\)</span> is a linear function of the parameters (<span class="math inline">\(\beta_0,\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> in this case). The fact that <span class="math inline">\(E(Y_i)\)</span> is not a linear function of the
independent variable <span class="math inline">\(x_i\)</span> is not important.</p>
<p>The model
<span class="math display">\[\begin{equation}
E(Y_i)=\beta_0+\beta_1 x + e^{\beta_2 x_i},
\end{equation}\]</span>
is not a linear model, because <span class="math inline">\(E(Y_i)\)</span> is not a linear function of
the parameter <span class="math inline">\(\beta_2\)</span>.</p>
<p>Typically, linear models are sufficient when the dependent variable
is a continuous quantity, and so are useful in a wide
variety of contexts. Linear models are not suitable when
the dependent variable is categorical or ordinal. (This requires the
use of <em>generalised</em> linear models, which are taught on the MSc).</p>
<p>The independent variable does not have to be continuous, and we can
have more than one independent variable. Continuing the <code>air quality</code> example, suppose we want to include <code>Wind</code> speed, and suppose we also know whether it was overcast at the time of measuring the variables. We could extend the model and write
<span class="math display">\[\begin{equation}
Y_i=\beta_0+ \beta_1 x_i + \beta_2 w_i + \beta_3 z_i +\varepsilon_i,
\end{equation}\]</span>
where <span class="math inline">\(w_i\)</span> is the wind speed for the <span class="math inline">\(i\)</span>th measurement, and
<span class="math inline">\(z_i\)</span> is a <strong>dummy variable</strong> representing cloud conditions:
<span class="math display">\[
z_i=\left\{\begin{array}{cl} 0 &amp; \mbox{overcast conditions for measurement $i$}\\
1 &amp; \mbox{not overcast conditions}
\end{array}\right.
\]</span></p>
<div class="example">
<p><span id="exm:exampleLMweights" class="example"><strong>Example 6.1  (Writing down a linear model.) </strong></span><br></p>
</div>
<p>Two objects <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are to be weighed. Each measurement is subject to a measurement error, with the measurement errors assumed to be independent <span class="math inline">\(N(0,\sigma^2)\)</span> random variables. Objects <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are weighed separately, and then together, so that there are three measurements in total. Write down a linear model that relates the measurements to the true weights. You may use more than one equation to do this.</p>
<div class="fold">
<p><strong>Solution</strong></p>
<p>Let <span class="math inline">\(\theta_A\)</span> and <span class="math inline">\(\theta_B\)</span> denote the true weights of the two objects, and <span class="math inline">\(Y_1,Y_2,Y_3\)</span> be the measurements. We have</p>
<p><span class="math display">\[\begin{align*}
Y_1 &amp;= \theta_A + \varepsilon_1,\\
Y_2 &amp;= \theta_B + \varepsilon_2,\\
Y_3 &amp;= \theta_A + \theta_B + \varepsilon_3,
\end{align*}\]</span>
with <span class="math inline">\(\varepsilon_1,\varepsilon_2,\varepsilon_3\stackrel{i.i.d}{\sim}N(0,\sigma^2)\)</span>. This is a linear model because <span class="math inline">\(E(Y_i)\)</span> is a linear combination of <span class="math inline">\(\theta_A\)</span> and <span class="math inline">\(\theta_B\)</span> for each <span class="math inline">\(i\)</span>.</p>
</div>
</div>
<div id="the-simple-linear-regression-model" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> The simple linear regression model<a href="introducing-linear-models.html#the-simple-linear-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We call the model</p>
<p><span class="math display">\[
Y_i=\beta_0+\beta_1 x_i +\varepsilon_i,
\]</span>
for
<span class="math inline">\(i=1,\ldots n\)</span> with <span class="math inline">\(\varepsilon_1,\ldots,\varepsilon_n \stackrel{i.i.d.}{\sim} N(0,\sigma^2)\)</span> the <strong>simple linear regression model</strong>. For obvious reasons, we refer to <span class="math inline">\(\beta_0\)</span> as the <strong>intercept</strong> parameter and <span class="math inline">\(\beta_1\)</span> as the <strong>gradient</strong> or <strong>slope</strong> parameter.</p>
<p>What is the distribution of
<span class="math inline">\(Y_i\)</span> for this model? Recall that for a random variable <span class="math inline">\(Z\)</span> and
constants <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>:
<span class="math display">\[\begin{eqnarray*}
E(aZ+b)&amp;=&amp;aE(Z) +b,\\
Var(aZ+b)&amp;=&amp;a^2Var(Z).
\end{eqnarray*}\]</span></p>
<p>Also, if <span class="math inline">\(Z\sim N(\mu,\sigma^2)\)</span> then <span class="math inline">\(aZ+b \sim N(a\mu+b,a^2\sigma^2)\)</span>. Now, if <span class="math inline">\(\varepsilon_i\sim N(0,\sigma^2)\)</span> and
<span class="math inline">\(\beta_0,\beta_1\)</span> and <span class="math inline">\(x_i\)</span> are constants then
we have <span class="math display">\[\begin{eqnarray} E(Y_i)&amp;=&amp; \beta_0 + \beta_1 x_i,\\
Var(Y_i)&amp;=&amp; \sigma^2,
\end{eqnarray}\]</span>
and
<span class="math display">\[\begin{equation}
Y_i \sim N(\beta_0 + \beta_1 x_i,
\sigma^2). \end{equation}\]</span>
Additionally, since
<span class="math inline">\(\varepsilon_1,\ldots,\varepsilon_n\)</span> are independent, it follows that <span class="math inline">\(Y_1,\ldots,Y_n\)</span>
are independent.</p>
<p>Note that we do not need to consider the case
<span class="math inline">\(E(\varepsilon_i)\neq 0\)</span>. Suppose we have a model
<span class="math display">\[\begin{equation}
Y_i = \gamma + \beta_1 x_i +\delta_i,
\end{equation}\]</span>
with <span class="math inline">\(\delta_i \sim N(\mu,\sigma^2)\)</span> and <span class="math inline">\(\mu \neq 0\)</span>. We can write
<span class="math display">\[\begin{equation} \delta_i = \mu + \varepsilon_i,
\end{equation}\]</span>
with <span class="math inline">\(\varepsilon_i \sim N(0,\sigma^2)\)</span> so that we can re-write this model
as
<span class="math display">\[\begin{equation}
y_i = \mu+ \gamma + \beta_1 x_i +\varepsilon_i.
\end{equation}\]</span>
If we now set <span class="math inline">\(\beta_0 = \mu + \gamma\)</span>, we see that this model
is indistinguishable from the simple linear regression
model. To put it another way, as we can write <span class="math inline">\(Y_i = E(Y_i) + \varepsilon_i\)</span>, we <em>must</em> have <span class="math inline">\(E(\varepsilon_i) = 0\)</span>.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>The data were obtained from the New York State Department of Conservation (ozone data) and the National Weather Service (meteorological data)<a href="introducing-linear-models.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="likelihood-for-confidence-intervals-and-hypothesis-tests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="parameter-estimation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
